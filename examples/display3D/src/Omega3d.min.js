function Vector3D(e,t,n){this.x=e;this.y=t;this.z=n;__construct=function(){}();this.add=function(e){this.x+=e.x;this.y+=e.y;this.z+=e.z;return this};this.subtract=function(e){this.x-=e.x;this.y-=e.y;this.z-=e.z;return this};this.multiply=function(e){this.x*=e;this.y*=e;this.z*=e;return this};this.zero=function(){this.x=0;this.y=0;this.z=0;return this}}function Object3D(e,t){this.id=(++OMEGA.Omega3D.ObjectsCount).toString();this.name="Object3d_"+this.id.toString();this.mayRender=true;this.next=null;this.prev=null;this.position=[0,0,0];this.rotation=[0,0,0];this.modelView=mat4.create();mat4.identity(this.modelView);this.mesh=e;this.material=t;this.drawType=OMEGA.Omega3D.Object3D.DEFAULT;if(this.mesh)this.mesh.CreateBuffers();this.setName=function(e){this.name=e};this.setMesh=function(e){this.mesh=e};this.setMaterial=function(e){this.material=e};this.SetMatrix=function(e){this.modelView=e};this.GetPosition=function(){return this.position};this.GetMesh=function(){return this.mesh};this.GetMaterial=function(){return this.material};this.GetMatrix=function(){return this.modelView};this.getName=function(){return this.name};this.getID=function(){return this.id};this.ResetPosition=function(){mat4.translate(this.modelView,this.modelView,this.position);this.Rotate(this.rotation[0],this.rotation[1],this.rotation[2])};this.SetPosition=function(e,t,n){this.position[0]=e;this.position[1]=t;this.position[2]=n;mat4.translate(this.modelView,this.modelView,this.position)};this.Translate=function(e,t,n){this.position[0]+=e;this.position[1]+=t;this.position[2]+=n;mat4.translate(this.modelView,this.modelView,this.position)};this.Rotate=function(e,t,n){this.RotateX(e);this.RotateY(t);this.RotateZ(n)};this.RotateX=function(e){this.rotation[0]=e;mat4.rotate(this.modelView,this.modelView,e,[1,0,0])};this.RotateY=function(e){this.rotation[1]=e;mat4.rotate(this.modelView,this.modelView,e,[0,1,0])};this.RotateZ=function(e){this.rotation[2]=e;mat4.rotate(this.modelView,this.modelView,e,[0,0,1])};this.toString=function(){return"Object3D { id: "+this.id+", name: "+this.name+"};"}}function Cube(e,t){Object3D.apply(this,[new Omega3D.Mesh(new Omega3D.Geometry.CubeGeometry(e)),t])}function Cylinder(e,t){Object3D.apply(this,[new Omega3D.Mesh(new Omega3D.Geometry.CylinderGeometry(e)),t])}function Plane(e,t,n){Object3D.apply(this,[new Omega3D.Mesh(new Omega3D.Geometry.SquareGeometry(e,t)),n])}function Sphere(e,t,n,r){Object3D.apply(this,[new Omega3D.Mesh(new Omega3D.Geometry.SphereGeometry(e,n,r)),t])}function Torus(e,t){Object3D.apply(this,[new Omega3D.Mesh(new Omega3D.Geometry.TorusGeometry(e)),t])}function Camera(){Object3D.apply(this);this.update=function(){};this.LookAt=function(e,t,n,r){mat4.lookAt(this.modelView,r||this.position,[e,t,n],[0,1,0])}}function FreeCamera(){Camera.apply(this);this.speed=.1;this.drag=.001;this.mass=10;this.pos=new Vector3D(0,0,0);this.vel=new Vector3D(0,0,0);this.rot=new Vector3D(0,0,0);this.rotF=new Vector3D(0,0,0);this.acc=new Vector3D(0,0,0);this.rot_acc=new Vector3D(0,0,0);this.currentlyPressedKeys=[];this.SetSpeed=function(e){this.speed=e};this.update=function(){this.HandleKeys();this.vel.x+=this.acc.x/this.mass;this.vel.y+=this.acc.y/this.mass;this.vel.z+=this.acc.z/this.mass;var e=this.rot.y+Math.PI/2;var t=Math.cos(e);var n=Math.sin(e);var r=Math.sin(this.rot.x);this.pos.x+=this.vel.z*t;this.pos.y+=this.vel.z*r;this.pos.z+=this.vel.z*n;this.acc.x*=this.drag;this.acc.y*=this.drag;this.acc.z*=this.drag;this.rot_acc.x=this.rot_acc.y=this.rot_acc.z=0;this.vel.x=this.vel.y=this.vel.z=0;this.Rotate(this.rot.x,this.rot.y,0);this.Translate(this.pos.x,this.pos.y,this.pos.z);this.rotF.zero();this.pos.zero()};this.HandleKeyDown=function(e){this.currentlyPressedKeys[e.keyCode]=true};this.HandleKeyUp=function(e){this.currentlyPressedKeys[e.keyCode]=false};this.HandleKeys=function(){if(this.currentlyPressedKeys[87]){this.vel.z=0;this.acc.z+=this.speed}if(this.currentlyPressedKeys[83]){this.vel.z=0;this.acc.z+=-this.speed}if(this.currentlyPressedKeys[39]||this.currentlyPressedKeys[68]||this.currentlyPressedKeys[102]){this.rotF.y=.05;this.rot.y+=this.rotF.y}if(this.currentlyPressedKeys[37]||this.currentlyPressedKeys[65]||this.currentlyPressedKeys[100]){this.rotF.y=-.05;this.rot.y+=this.rotF.y}if(this.currentlyPressedKeys[38]||this.currentlyPressedKeys[104]){this.rotF.x=-.05;this.rot.x+=this.rotF.x}if(this.currentlyPressedKeys[40]||this.currentlyPressedKeys[98]){this.rotF.x=.05;this.rot.x+=this.rotF.x}};document.omega_freecam=this;document.onkeydown=function(e){document.omega_freecam.HandleKeyDown(e)};document.onkeyup=function(e){document.omega_freecam.HandleKeyUp(e)}}function Material(e,t){this.materialID="material_"+ ++OMEGA.Omega3D.MaterialsCount;this.texture=t;this.shader=e;this.GetTexture=function(){return this.texture};this.GetShader=function(){return this.shader};this.GetID=function(){return this.materialID};this.Enable=function(){if(this.shader)this.shader.Enable();if(this.texture)this.texture.Enable(this.shader)};this.Disable=function(){if(this.shader)this.shader.Disable();if(this.texture)this.texture.Disable()}}function Shader(e,t){this.GetVertexShaderSource=function(){return this.vertex_shader_src};this.GetFragmentShaderSource=function(){return this.fragment_shader_src};this.GetVertexShader=function(){return this.vertex_shader};this.GetFragmentShader=function(){return this.fragment_shader};this.GetProgram=function(){return this.program};this.Enable=function(){if(!this.program)return;this.gl_context.useProgram(this.program)};this.Disable=function(){if(!this.program)return;this.gl_context.useProgram(null)};this.createProgram=function(){if(this.vertex_shader==null||this.fragment_shader==null)return;var e=this.gl_context.createProgram();this.gl_context.attachShader(e,this.vertex_shader);this.gl_context.attachShader(e,this.fragment_shader);this.gl_context.linkProgram(e);if(!this.gl_context.getProgramParameter(e,this.gl_context.LINK_STATUS)){console.log("Could not initialize shaders / program");return null}e.aVertexPos=this.gl_context.getAttribLocation(e,"aVertexPos");e.aTextureCoord=this.gl_context.getAttribLocation(e,"aTextureCoord");e.aVertexNormal=this.gl_context.getAttribLocation(e,"aVertexNormal");e.uPointSize=this.gl_context.getUniformLocation(e,"uPointSize");e.uProjectionMatrix=this.gl_context.getUniformLocation(e,"uProjectionMatrix");e.uViewMatrix=this.gl_context.getUniformLocation(e,"uViewMatrix");e.uInvViewMatrix=this.gl_context.getUniformLocation(e,"uInvViewMatrix");e.uModelMatrix=this.gl_context.getUniformLocation(e,"uModelMatrix");e.uNormalMatrix=this.gl_context.getUniformLocation(e,"uNormalMatrix");e.uKernel=this.gl_context.getUniformLocation(e,"uKernel");e.uTime=this.gl_context.getUniformLocation(e,"uTime");return e};this.createShaderElement=function(e,t){if(!t)return null;var n=this.gl_context.createShader(e);this.gl_context.shaderSource(n,t);this.gl_context.compileShader(n);if(!this.gl_context.getShaderParameter(n,this.gl_context.COMPILE_STATUS)){console.log((e==this.gl_context.VERTEX_SHADER?"Vertex shader: ":"Fragment shader: ")+this.gl_context.getShaderInfoLog(n));return null}else{console.log((e==this.gl_context.VERTEX_SHADER?"Vertex shader: ":"Fragment shader: ")+"succesfully compiled!")}return n};this.vertex_shader_src=e;this.fragment_shader_src=t;this.gl_context=OMEGA.Omega3D.GL;this.vertex_shader=this.gl_context?this.createShaderElement(this.gl_context.VERTEX_SHADER,this.vertex_shader_src):null;this.fragment_shader=this.gl_context?this.createShaderElement(this.gl_context.FRAGMENT_SHADER,this.fragment_shader_src):null;this.program=this.gl_context?this.createProgram():null}function PostProcessingShader(e,t){Shader.apply(this,[e,t])}function PostProcessingKernelShader(e,t,n){Shader.apply(this,[e,t]);this.kernel=n;this.getKernel=function(){return this.kernel}}function Texture(e,t){if(!OMEGA.Omega3D.GL)return null;this.gl_context=OMEGA.Omega3D.GL;this.img=e;this.isCubeMap=true;this.needsUpdate=t||false;this.tex=this.gl_context.createTexture();this.GetTexture=function(){return this.tex};this.GetImage=function(){return this.img};this.handleTextureLoaded=function(e,t){};this.Enable=function(e){};this.Disable=function(){};this.Update=function(){this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,this.tex);this.gl_context.pixelStorei(this.gl_context.UNPACK_FLIP_Y_WEBGL,true);this.gl_context.texImage2D(this.gl_context.TEXTURE_2D,0,this.gl_context.RGBA,this.gl_context.RGBA,this.gl_context.UNSIGNED_BYTE,this.img)};this.GenerateMipmap=function(){this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,this.tex);this.gl_context.generateMipmap(this.gl_context.TEXTURE_2D);this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,null)}}function FrameBufferTexture(e,t){Texture.apply(this,[null,true]);var n,r;n=this.gl_context.createFramebuffer();this.gl_context.bindFramebuffer(this.gl_context.FRAMEBUFFER,n);n.width=e||512;n.height=t||512;this.tex=this.gl_context.createTexture();this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,this.tex);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_WRAP_S,this.gl_context.CLAMP_TO_EDGE);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_WRAP_T,this.gl_context.CLAMP_TO_EDGE);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MAG_FILTER,this.gl_context.LINEAR);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MIN_FILTER,this.gl_context.LINEAR);this.gl_context.texImage2D(this.gl_context.TEXTURE_2D,0,this.gl_context.RGBA,n.width,n.height,0,this.gl_context.RGBA,this.gl_context.UNSIGNED_BYTE,null);var r=this.gl_context.createRenderbuffer();this.gl_context.bindRenderbuffer(this.gl_context.RENDERBUFFER,r);this.gl_context.renderbufferStorage(this.gl_context.RENDERBUFFER,this.gl_context.DEPTH_COMPONENT16,n.width,n.height);this.gl_context.framebufferTexture2D(this.gl_context.FRAMEBUFFER,this.gl_context.COLOR_ATTACHMENT0,this.gl_context.TEXTURE_2D,this.tex,0);this.gl_context.framebufferRenderbuffer(this.gl_context.FRAMEBUFFER,this.gl_context.DEPTH_ATTACHMENT,this.gl_context.RENDERBUFFER,r);this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,null);this.gl_context.bindRenderbuffer(this.gl_context.RENDERBUFFER,null);this.gl_context.bindFramebuffer(this.gl_context.FRAMEBUFFER,null);this.Enable=function(e){this.gl_context.bindRenderbuffer(this.gl_context.RENDERBUFFER,r);this.gl_context.activeTexture(this.gl_context.TEXTURE0);this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,this.tex);if(e){var t=this.gl_context.getUniformLocation(e.GetProgram(),"uSampler");this.gl_context.uniform1i(t,0)}};this.GetFrameBuffer=function(){return n};this.Disable=function(){this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,null);this.gl_context.bindRenderbuffer(this.gl_context.RENDERBUFFER,null)}}function CubemapTexture(e,t){Texture.apply(this,arguments);this.handleTextureLoaded=function(e,t){this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,t);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_WRAP_S,this.gl_context.CLAMP_TO_EDGE);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_WRAP_T,this.gl_context.CLAMP_TO_EDGE);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_MIN_FILTER,this.gl_context.LINEAR);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_MAG_FILTER,this.gl_context.LINEAR);var n=[this.gl_context.TEXTURE_CUBE_MAP_POSITIVE_X,this.gl_context.TEXTURE_CUBE_MAP_NEGATIVE_X,this.gl_context.TEXTURE_CUBE_MAP_POSITIVE_Y,this.gl_context.TEXTURE_CUBE_MAP_NEGATIVE_Y,this.gl_context.TEXTURE_CUBE_MAP_POSITIVE_Z,this.gl_context.TEXTURE_CUBE_MAP_NEGATIVE_Z];for(var r=0;r<n.length;r++){var i=n[r];var s=e[r];this.gl_context.pixelStorei(this.gl_context.UNPACK_FLIP_Y_WEBGL,false);this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,t);this.gl_context.texImage2D(i,0,this.gl_context.RGBA,this.gl_context.RGBA,this.gl_context.UNSIGNED_BYTE,s);this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,null)}return t};this.Enable=function(e){this.gl_context.activeTexture(this.gl_context.TEXTURE0);this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,this.tex);if(e){var t=this.gl_context.getUniformLocation(e.GetProgram(),"uSampler");this.gl_context.uniform1i(t,0)}};this.Disable=function(){this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,null)};this.handleTextureLoaded(this.img,this.tex)}function BasicTexture(e,t){Texture.apply(this,arguments);this.handleTextureLoaded=function(e,t){if(!this.needsUpdate){this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,t);if(e)this.gl_context.texImage2D(this.gl_context.TEXTURE_2D,0,this.gl_context.RGBA,this.gl_context.RGBA,this.gl_context.UNSIGNED_BYTE,e);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MAG_FILTER,this.gl_context.NEAREST);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MIN_FILTER,this.gl_context.NEAREST);if(e)this.gl_context.generateMipmap(this.gl_context.TEXTURE_2D);this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,null)}else{this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,t);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MAG_FILTER,this.gl_context.LINEAR);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MIN_FILTER,this.gl_context.LINEAR);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_WRAP_S,this.gl_context.CLAMP_TO_EDGE);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_WRAP_T,this.gl_context.CLAMP_TO_EDGE)}};this.Enable=function(e){this.gl_context.activeTexture(this.gl_context.TEXTURE0);this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,this.tex);if(e&&this.img){var t=this.gl_context.getUniformLocation(e.GetProgram(),"uSampler");this.gl_context.uniform1i(t,0)}};this.Disable=function(){this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,null)};this.handleTextureLoaded(this.img,this.tex)}function Mesh(e){this.vertexBuffer;this.normalBuffer;this.indexBuffer;this.uvBuffer;this.geometry=e;this.gl=OMEGA.Omega3D.GL;this.GetVertexBuffer=function(){return this.vertexBuffer};this.GetUVBuffer=function(){return this.uvBuffer};this.GetIndexBuffer=function(){return this.indexBuffer};this.GetNormalBuffer=function(){return this.normalBuffer};this.GetIndexCount=function(){return this.geometry.GetIndexes()/3};this.GetGeometry=function(){return this.geometry};this.ApplyGeometry=function(e){this.geometry=e;this.CreateBuffers()};this.CreateBuffers=function(){this.vertexBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.geometry.GetVertices()),this.gl.STATIC_DRAW);this.vertexBuffer.itemSize=3;this.vertexBuffer.numItems=this.geometry.GetVertices().length/this.vertexBuffer.itemSize;if(this.geometry.GetNormals().length>0){this.normalBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.normalBuffer);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.geometry.GetNormals()),this.gl.STATIC_DRAW);this.normalBuffer.itemSize=3;this.normalBuffer.numItems=this.geometry.GetNormals().length/3}this.indexBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.geometry.GetIndexes()),this.gl.STATIC_DRAW);this.indexBuffer.itemSize=1;this.indexBuffer.numItems=this.geometry.GetIndexes().length;this.uvBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvBuffer);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.geometry.GetUVS()),this.gl.STATIC_DRAW);this.uvBuffer.itemSize=2;this.uvBuffer.numItems=this.geometry.GetUVS().length/this.uvBuffer.itemSize}}function Geometry(e){this.vertices=new Array;this.normals=new Array;this.uvs=new Array;this.indexes=new Array;this.faces=new Array;this.scale=e||.1;this.SetVertices=function(e){this.vertices=e};this.SetNormals=function(e){this.normals=e};this.SetUVS=function(e){this.uvs=e};this.SetIndexes=function(e){this.indexes=e};this.SetFaces=function(e){this.faces=e};this.GetVertices=function(){return this.vertices};this.GetNormals=function(){return this.normals};this.GetUVS=function(){return this.uvs};this.GetIndexes=function(){return this.indexes};this.GetFaces=function(){return this.faces}}function CubeGeometry(e){Geometry.apply(this,arguments);var t=this.scale;this.vertices=[-1*t,-1*t,1*t,1*t,-1*t,1*t,1*t,1*t,1*t,-1*t,1*t,1*t,-1*t,-1*t,-1*t,-1*t,1*t,-1*t,1*t,1*t,-1*t,1*t,-1*t,-1*t,-1*t,1*t,-1*t,-1*t,1*t,1*t,1*t,1*t,1*t,1*t,1*t,-1*t,-1*t,-1*t,-1*t,1*t,-1*t,-1*t,1*t,-1*t,1*t,-1*t,-1*t,1*t,1*t,-1*t,-1*t,1*t,1*t,-1*t,1*t,1*t,1*t,1*t,-1*t,1*t,-1*t,-1*t,-1*t,-1*t,-1*t,1*t,-1*t,1*t,1*t,-1*t,1*t,-1*t];this.normals=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0];this.indexes=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];this.uvs=[0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1];console.log("GEOMETRY : cube created")}function CylinderGeometry(e){Geometry.apply(this,arguments);var t=this.scale;var n=this.scale*.25;var r=15;var i=10;var s=.5;var o,u,a;var f,l;for(var c=0;c<i;c++){for(var h=0;h<r;h++){f=Math.PI*2/(r-1)*h;l=Math.PI*c/(i-1)-Math.PI/2;o=Math.cos(f)*n;u=c*(t/i)-t/2;a=Math.sin(f)*n;this.vertices.push(o);this.vertices.push(u);this.vertices.push(a);this.normals.push(Math.cos(f));this.normals.push(0);this.normals.push(Math.sin(f));this.uvs.push(h/(r-1));this.uvs.push(c/(i-1));if(c<i-1&&h<r-1){this.indexes.push(c*r+h);this.indexes.push(c*r+h+1);this.indexes.push((c+1)*r+h);this.indexes.push(c*r+h+1);this.indexes.push((c+1)*r+h+1);this.indexes.push((c+1)*r+h)}}}console.log("GEOMETRY : cillinder created")}function SphereGeometry(e,t,n){Geometry.apply(this,[e]);var r=this.scale;var n=t||15;var t=n||15;var i=0;var s=0;for(var o=0;o<n;o++){for(var u=0;u<t;u++){i=Math.PI*2/(t-1)*u;s=Math.PI*o/(n-1)-Math.PI/2;var a=Math.cos(i)*r*Math.cos(s);var f=Math.sin(s)*r;var l=Math.sin(i)*r*Math.cos(s);this.vertices.push(a);this.vertices.push(f);this.vertices.push(l);this.normals.push(Math.cos(i)*Math.cos(s),Math.sin(s),Math.sin(i)*Math.cos(s));this.uvs.push(u/(t-1),1-o/(n-1))}}for(var o=0;o<n;o++){for(var u=0;u<t;u++){if(o<n-1&&u<t-1){this.indexes.push(o*t+u,o*t+u+1,(o+1)*t+u);this.indexes.push(o*t+u+1,(o+1)*t+u+1,(o+1)*t+u)}}}console.log("GEOMETRY : sphere created")}function SquareGeometry(e,t){Geometry.apply(this,[]);var n=e/2||1;var r=t/2||1;var i=150;var s=150;var o=e/(i-1);var u=t/(s-1);for(var a=0;a<s;a++){for(var f=0;f<i;f++){var l=-n+f*o;var c=-r+a*u;var h=0;this.vertices.push(l,c,h);this.normals.push(0);this.normals.push(0);this.normals.push(1);this.uvs.push(f/(i-1));this.uvs.push(a/(s-1));if(a<s-1&&f<i-1){this.indexes.push(a*i+f);this.indexes.push(a*i+f+1);this.indexes.push((a+1)*i+f);this.indexes.push(a*i+f+1);this.indexes.push((a+1)*i+f+1);this.indexes.push((a+1)*i+f)}}}console.log("GEOMETRY : square created")}function TorusGeometry(e){Geometry.apply(this,arguments);var t=50;var n=35;var r=this.scale;var i=r/2;var s,o,u,a,f,l;var c=0;var h=0;for(var p=0;p<t;p++){c=Math.PI*2/(t-1)*p;for(var d=0;d<n;d++){h=Math.PI*2/(n-1)*d;s=Math.cos(c)*(Math.cos(h)*i+r);o=Math.sin(c)*(Math.cos(h)*i+r);u=Math.sin(h)*i;a=Math.cos(c)*Math.cos(h);f=Math.sin(c)*Math.cos(h);l=Math.sin(h);this.vertices.push(s);this.vertices.push(o);this.vertices.push(u);this.normals.push(a);this.normals.push(f);this.normals.push(l);this.uvs.push(d/(n-1));this.uvs.push(p/(t-1));if(p<t-1&&d<n-1){this.indexes.push(p*n+d);this.indexes.push(p*n+d+1);this.indexes.push((p+1)*n+d);this.indexes.push(p*n+d+1);this.indexes.push((p+1)*n+d+1);this.indexes.push((p+1)*n+d)}}}for(var p=0;p<this.indexes.length;p+=9){var v={x:this.vertices[this.indexes[p]],y:this.vertices[this.indexes[p+1]],z:this.vertices[this.indexes[p+2]]};var m={x:this.vertices[this.indexes[p+3]],y:this.vertices[this.indexes[p+4]],z:this.vertices[this.indexes[p+5]]};var g={x:this.vertices[this.indexes[p+6]],y:this.vertices[this.indexes[p+7]],z:this.vertices[this.indexes[p+8]]};this.faces.push({a:v,b:m,c:g})}console.log("GEOMETRY : torus created")}function TriangleGeometry(e){Geometry.apply(this,arguments);this.vertices=[0,1*this.scale,0,-1*this.scale,-1*this.scale,0,1*this.scale,-1*this.scale,0];this.uvs=[.98,.98,.6,0,0,.6];this.normals=[0,0,1,0,0,1,0,0,1];this.indexes=[0,1,2]}function OBJParser(){var e=String.fromCharCode(10);var t=String.fromCharCode(32);var n="/";var r="v";var i="vn";var s="vt";var o="f";var u=false;var a=1;var f=false;var l=0;var c=new Array,h=new Array,p=new Array,d=new Array;var v=new Array,m=new Array,g=new Array,y=new Array,b=new Array;this.GetVertices=function(){return v};this.GetNormals=function(){return m};this.GetUVS=function(){return g};this.GetIndexes=function(){return b};this.ParseToObject3D=function(e,t,n){this.parseFile(e,t);var r=new Omega3D.Geometry;r.SetVertices(this.GetVertices());r.SetNormals(this.GetNormals());r.SetUVS(this.GetUVS());r.SetIndexes(this.GetIndexes());var i=new Omega3D.Mesh(r);var s=new Omega3D.Object3D(i,n);w();return s};this.ParseToMesh=function(e,t){this.parseFile(e,t);var n=new Omega3D.Geometry;n.SetVertices(this.GetVertices());n.SetNormals(this.GetNormals());n.SetUVS(this.GetUVS());n.SetIndexes(this.GetIndexes());var r=new Omega3D.Mesh(n);w();return r};this.parseFile=function(t,n){var r=new XMLHttpRequest;r.open("GET",t,false);r.send();a=n;var i=r.responseText;var s=i.split(e);var o=s.length;for(var u=0;u<o;u++){this.parseLine(s[u])}console.log(t+" has been parsed, some info:");console.log("VERTEXES : "+v.length/3);console.log("NORMALS  : "+m.length/3);console.log("UV       : "+g.length/2);console.log("INDEXES  : "+b.length)};this.parseLine=function(e){var n=e.split(t);var u;if(n.length>0)u=n.slice(1);else return;var a=n[0];switch(a){case r:this.parseVertex(u);break;case i:this.parseNormal(u);break;case s:this.parseUV(u);break;case o:this.parseIndex(u);break}};this.parseVertex=function(e){if(e[0]==""||e[0]==" ")e=e.slice(1);if(u){c.push(parseFloat(e[1])*a);c.push(parseFloat(e[2])*a);c.push(parseFloat(e[0])*a)}else{var t=e.length;if(t>3)t=3;for(var n=0;n<t;++n){var r=e[n];d.push(Math.random());c.push(parseFloat(r)*a)}d.push(1)}};this.parseNormal=function(e){if(e[0]==""||e[0]==" ")e=e.slice(1);var t=e.length;if(t>3)t=3;for(var n=0;n<t;++n){var r=e[n];if(r!=null)h.push(parseFloat(r))}};this.parseUV=function(e){if(e[0]==""||e[0]==" ")e=e.slice(1);var t=e.length;if(t>2)t=2;for(var n=0;n<t;++n){var r=e[n];p.push(Number(r))}};this.parseIndex=function(e){var t;var r;var i;var s;var o;var u;var a;var d=e.length;var w=0;while(e[w]==""||e[w]==" ")w++;d=w+3;for(a=w;a<d;++a){t=e[a];r=t.split(n);i=parseInt(r[0])-1;s=parseInt(r[1])-1;o=parseInt(r[2])-1;if(i<0)i=0;if(s<0)s=0;if(o<0)o=0;u=3*i;v.push(c[u+0],c[u+1],c[u+2]);y.push(Math.random(),Math.random(),Math.random(),1);if(h.length){u=3*o;m.push(h[u+0],h[u+1],h[u+2])}u=2*s;if(f)g.push(p[u+0],1-p[u+1]);else g.push(1-p[u+0],1-p[u+1])}b.push(l+0,l+1,l+2);l+=3};var w=function(){v=new Array;m=new Array;g=new Array;y=new Array;b=new Array;c=new Array;h=new Array;p=new Array;d=new Array;l=0}}function RenderPass(e,t,n){this.next=null;this.prev=null;var r=t;var e=e;var n=n||null;this.render=function(){r.apply(e,n)}}function WebGLRenderer(e){var t=null;var n=null;var r=null;var i=null;this.passes=new Array;this.materials=null;this.objects=null;this.list=null;var s=e||false;__construct=function(){t=mat4.create();this.materials=new Array;this.objects=new Array;this.list=new Array;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}()}();this.addRenderPass=function(e){this.passes.push(e);if(!r){r=e;i=r}else{e.prev=i;i.next=e;i=e}};this.render=function(){var e=r;while(e){e.render();e=e.next}};this.renderSceneToTexture=function(e,t,n){t.update();this.materials=e.materials;this.objects=e.objects;this.list=e.list;e.getGL().bindFramebuffer(e.getGL().FRAMEBUFFER,n.GetFrameBuffer());this.basicRender(e,t,n.GetFrameBuffer());e.getGL().bindFramebuffer(e.getGL().FRAMEBUFFER,null);e.updateTimer();mat4.identity(t.GetMatrix())};this.renderScene=function(e,t){t.update();this.materials=e.materials;this.objects=e.objects;this.list=e.list;this.basicRender(e,t,null);e.updateTimer();mat4.identity(t.GetMatrix())};this.basicRender=function(e,n,r){if(s)console.log("Renderer.Render START");var i=e.getGL();var a=e.getColor();i.clearColor(a.r,a.g,a.b,a.a);i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT);i.viewport(0,0,r?r.width:i.viewPortWidth,r?r.height:i.viewPortHeight);mat4.perspective(t,45,(r?r.width:i.viewPortWidth)/(r?r.height:i.viewPortHeight),.1,1e3);for(var f=0;f<this.materials.length;f++){var l=this.materials[f].id;var c=this.materials[f].material;if(this.objects[l].length==0)continue;if(s){console.log("Current Material ID :  "+l+"\nAmount Objects for this material: "+this.objects[l].length)}if(c.GetTexture().needsUpdate)c.GetTexture().Update();c.Enable();n.SetPosition(n.position[0],n.position[1],n.position[2]);if(c.GetShader().GetProgram().uProjectionMatrix)i.uniformMatrix4fv(c.GetShader().GetProgram().uProjectionMatrix,false,t);if(c.GetShader().GetProgram().uViewMatrix)i.uniformMatrix4fv(c.GetShader().GetProgram().uViewMatrix,false,n.GetMatrix());if(c.GetShader().GetProgram().uKernel)i.uniform1fv(c.GetShader().GetProgram().uKernel,c.GetShader().getKernel());if(c.GetShader().GetProgram().uTime)i.uniform1f(c.GetShader().GetProgram().uTime,e.getTime());if(c.GetShader().GetProgram().uInvViewMatrix){var h=mat4.create();mat4.invert(h,n.GetMatrix());mat4.transpose(h,h);i.uniformMatrix4fv(c.GetShader().GetProgram().uInvViewMatrix,false,h)}if(e.getLights().length>0)u(e,c);var p=this.list[l].head;while(p){if(p.mayRender){o(i,p,c,n);if(s)console.log("-  Current object: "+p)}p=p.next}c.Disable()}if(s)console.log("Renderer.Render END")};var o=function(e,t,n,r){var i=n.GetShader().GetProgram();e.uniformMatrix4fv(i.uModelMatrix,false,t.GetMatrix());var s=mat4.create();mat4.multiply(s,t.GetMatrix(),r.GetMatrix());mat4.invert(s,s);mat4.transpose(s,s);e.uniformMatrix4fv(i.uNormalMatrix,false,s);e.uniform1f(i.uPointSize,parseFloat(OMEGA.Omega3D.PointSize));e.enableVertexAttribArray(i.aVertexPos);e.bindBuffer(e.ARRAY_BUFFER,t.GetMesh().GetVertexBuffer());e.vertexAttribPointer(i.aVertexPos,t.GetMesh().GetVertexBuffer().itemSize,e.FLOAT,false,0,0);if(i.aTextureCoord!=-1){e.enableVertexAttribArray(i.aTextureCoord);e.bindBuffer(e.ARRAY_BUFFER,t.GetMesh().GetUVBuffer());e.vertexAttribPointer(i.aTextureCoord,t.GetMesh().GetUVBuffer().itemSize,e.FLOAT,false,0,0)}if(i.aVertexNormal!=-1&&t.GetMesh().GetNormalBuffer()!=undefined){e.enableVertexAttribArray(i.aVertexNormal);e.bindBuffer(e.ARRAY_BUFFER,t.GetMesh().GetNormalBuffer());e.vertexAttribPointer(i.aVertexNormal,t.GetMesh().GetNormalBuffer().itemSize,e.FLOAT,false,0,0)}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.GetMesh().GetIndexBuffer());if(t.drawType==OMEGA.Omega3D.Object3D.DEFAULT)e.drawElements(e.TRIANGLES,t.GetMesh().GetIndexBuffer().numItems,e.UNSIGNED_SHORT,t.GetMesh().GetIndexBuffer());else if(t.drawType==OMEGA.Omega3D.Object3D.WIREFRAME)e.drawElements(e.LINE_STRIP,t.GetMesh().GetIndexBuffer().numItems,e.UNSIGNED_SHORT,t.GetMesh().GetIndexBuffer());else if(t.drawType==OMEGA.Omega3D.Object3D.POINTS)e.drawArrays(e.POINTS,0,t.GetMesh().GetVertexBuffer().numItems);mat4.identity(t.GetMatrix());t.ResetPosition()};var u=function(e,t){var n=e.getGL();var r=e.getLights()[0];var i=t.GetShader().GetProgram();i.uLightPosition=n.getUniformLocation(i,"uLightPosition");i.uLightDirection=n.getUniformLocation(i,"uLightDirection");i.uAmbientColor=n.getUniformLocation(i,"uAmbientColor");i.uDiffuseColor=n.getUniformLocation(i,"uDiffuseColor");i.uSpecularColor=n.getUniformLocation(i,"uSpecularColor");if(i.uLightPosition!=-1)n.uniform3fv(i.uLightPosition,r.position);if(i.uLightDirection!=-1)n.uniform3fv(i.uAmbientColor,r.ambientColor);if(i.uAmbientColor!=-1)n.uniform3fv(i.uAmbientColor,r.ambientColor);if(i.uDiffuseColor!=-1)n.uniform3fv(i.uDiffuseColor,r.diffuseColor);if(i.uSpecularColor!=-1)n.uniform3fv(i.uSpecularColor,r.specularColor)};var a=function(e,t){for(var n=0;n<e.length;n++){if(e[n]===t){return true}}return false}}if(!GLMAT_EPSILON){var GLMAT_EPSILON=1e-6}if(!GLMAT_ARRAY_TYPE){var GLMAT_ARRAY_TYPE=typeof Float32Array!=="undefined"?Float32Array:Array}if(!GLMAT_RANDOM){var GLMAT_RANDOM=Math.random}var glMatrix={};glMatrix.setMatrixArrayType=function(e){GLMAT_ARRAY_TYPE=e};if(typeof exports!=="undefined"){exports.glMatrix=glMatrix}var degree=Math.PI/180;glMatrix.toRadian=function(e){return e*degree};var mat4={};mat4.create=function(){var e=new GLMAT_ARRAY_TYPE(16);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};mat4.clone=function(e){var t=new GLMAT_ARRAY_TYPE(16);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t};mat4.copy=function(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e};mat4.identity=function(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};mat4.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],s=t[6],o=t[7],u=t[11];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=n;e[6]=t[9];e[7]=t[13];e[8]=r;e[9]=s;e[11]=t[14];e[12]=i;e[13]=o;e[14]=u}else{e[0]=t[0];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=t[1];e[5]=t[5];e[6]=t[9];e[7]=t[13];e[8]=t[2];e[9]=t[6];e[10]=t[10];e[11]=t[14];e[12]=t[3];e[13]=t[7];e[14]=t[11];e[15]=t[15]}return e};mat4.invert=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=t[6],f=t[7],l=t[8],c=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15],y=n*u-r*o,b=n*a-i*o,w=n*f-s*o,E=r*a-i*u,S=r*f-s*u,x=i*f-s*a,T=l*v-c*d,N=l*m-h*d,C=l*g-p*d,k=c*m-h*v,L=c*g-p*v,A=h*g-p*m,O=y*A-b*L+w*k+E*C-S*N+x*T;if(!O){return null}O=1/O;e[0]=(u*A-a*L+f*k)*O;e[1]=(i*L-r*A-s*k)*O;e[2]=(v*x-m*S+g*E)*O;e[3]=(h*S-c*x-p*E)*O;e[4]=(a*C-o*A-f*N)*O;e[5]=(n*A-i*C+s*N)*O;e[6]=(m*w-d*x-g*b)*O;e[7]=(l*x-h*w+p*b)*O;e[8]=(o*L-u*C+f*T)*O;e[9]=(r*C-n*L-s*T)*O;e[10]=(d*S-v*w+g*y)*O;e[11]=(c*w-l*S-p*y)*O;e[12]=(u*N-o*k-a*T)*O;e[13]=(n*k-r*N+i*T)*O;e[14]=(v*b-d*E-m*y)*O;e[15]=(l*E-c*b+h*y)*O;return e};mat4.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=t[6],f=t[7],l=t[8],c=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15];e[0]=u*(h*g-p*m)-c*(a*g-f*m)+v*(a*p-f*h);e[1]=-(r*(h*g-p*m)-c*(i*g-s*m)+v*(i*p-s*h));e[2]=r*(a*g-f*m)-u*(i*g-s*m)+v*(i*f-s*a);e[3]=-(r*(a*p-f*h)-u*(i*p-s*h)+c*(i*f-s*a));e[4]=-(o*(h*g-p*m)-l*(a*g-f*m)+d*(a*p-f*h));e[5]=n*(h*g-p*m)-l*(i*g-s*m)+d*(i*p-s*h);e[6]=-(n*(a*g-f*m)-o*(i*g-s*m)+d*(i*f-s*a));e[7]=n*(a*p-f*h)-o*(i*p-s*h)+l*(i*f-s*a);e[8]=o*(c*g-p*v)-l*(u*g-f*v)+d*(u*p-f*c);e[9]=-(n*(c*g-p*v)-l*(r*g-s*v)+d*(r*p-s*c));e[10]=n*(u*g-f*v)-o*(r*g-s*v)+d*(r*f-s*u);e[11]=-(n*(u*p-f*c)-o*(r*p-s*c)+l*(r*f-s*u));e[12]=-(o*(c*m-h*v)-l*(u*m-a*v)+d*(u*h-a*c));e[13]=n*(c*m-h*v)-l*(r*m-i*v)+d*(r*h-i*c);e[14]=-(n*(u*m-a*v)-o*(r*m-i*v)+d*(r*a-i*u));e[15]=n*(u*h-a*c)-o*(r*h-i*c)+l*(r*a-i*u);return e};mat4.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=e[8],l=e[9],c=e[10],h=e[11],p=e[12],d=e[13],v=e[14],m=e[15],g=t*o-n*s,y=t*u-r*s,b=t*a-i*s,w=n*u-r*o,E=n*a-i*o,S=r*a-i*u,x=f*d-l*p,T=f*v-c*p,N=f*m-h*p,C=l*v-c*d,k=l*m-h*d,L=c*m-h*v;return g*L-y*k+b*C+w*N-E*T+S*x};mat4.multiply=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=t[7],c=t[8],h=t[9],p=t[10],d=t[11],v=t[12],m=t[13],g=t[14],y=t[15];var b=n[0],w=n[1],E=n[2],S=n[3];e[0]=b*r+w*u+E*c+S*v;e[1]=b*i+w*a+E*h+S*m;e[2]=b*s+w*f+E*p+S*g;e[3]=b*o+w*l+E*d+S*y;b=n[4];w=n[5];E=n[6];S=n[7];e[4]=b*r+w*u+E*c+S*v;e[5]=b*i+w*a+E*h+S*m;e[6]=b*s+w*f+E*p+S*g;e[7]=b*o+w*l+E*d+S*y;b=n[8];w=n[9];E=n[10];S=n[11];e[8]=b*r+w*u+E*c+S*v;e[9]=b*i+w*a+E*h+S*m;e[10]=b*s+w*f+E*p+S*g;e[11]=b*o+w*l+E*d+S*y;b=n[12];w=n[13];E=n[14];S=n[15];e[12]=b*r+w*u+E*c+S*v;e[13]=b*i+w*a+E*h+S*m;e[14]=b*s+w*f+E*p+S*g;e[15]=b*o+w*l+E*d+S*y;return e};mat4.mul=mat4.multiply;mat4.translate=function(e,t,n){var r=n[0],i=n[1],s=n[2],o,u,a,f,l,c,h,p,d,v,m,g;if(t===e){e[12]=t[0]*r+t[4]*i+t[8]*s+t[12];e[13]=t[1]*r+t[5]*i+t[9]*s+t[13];e[14]=t[2]*r+t[6]*i+t[10]*s+t[14];e[15]=t[3]*r+t[7]*i+t[11]*s+t[15]}else{o=t[0];u=t[1];a=t[2];f=t[3];l=t[4];c=t[5];h=t[6];p=t[7];d=t[8];v=t[9];m=t[10];g=t[11];e[0]=o;e[1]=u;e[2]=a;e[3]=f;e[4]=l;e[5]=c;e[6]=h;e[7]=p;e[8]=d;e[9]=v;e[10]=m;e[11]=g;e[12]=o*r+l*i+d*s+t[12];e[13]=u*r+c*i+v*s+t[13];e[14]=a*r+h*i+m*s+t[14];e[15]=f*r+p*i+g*s+t[15]}return e};mat4.scale=function(e,t,n){var r=n[0],i=n[1],s=n[2];e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;e[3]=t[3]*r;e[4]=t[4]*i;e[5]=t[5]*i;e[6]=t[6]*i;e[7]=t[7]*i;e[8]=t[8]*s;e[9]=t[9]*s;e[10]=t[10]*s;e[11]=t[11]*s;e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e};mat4.rotate=function(e,t,n,r){var i=r[0],s=r[1],o=r[2],u=Math.sqrt(i*i+s*s+o*o),a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;if(Math.abs(u)<GLMAT_EPSILON){return null}u=1/u;i*=u;s*=u;o*=u;a=Math.sin(n);f=Math.cos(n);l=1-f;c=t[0];h=t[1];p=t[2];d=t[3];v=t[4];m=t[5];g=t[6];y=t[7];b=t[8];w=t[9];E=t[10];S=t[11];x=i*i*l+f;T=s*i*l+o*a;N=o*i*l-s*a;C=i*s*l-o*a;k=s*s*l+f;L=o*s*l+i*a;A=i*o*l+s*a;O=s*o*l-i*a;M=o*o*l+f;e[0]=c*x+v*T+b*N;e[1]=h*x+m*T+w*N;e[2]=p*x+g*T+E*N;e[3]=d*x+y*T+S*N;e[4]=c*C+v*k+b*L;e[5]=h*C+m*k+w*L;e[6]=p*C+g*k+E*L;e[7]=d*C+y*k+S*L;e[8]=c*A+v*O+b*M;e[9]=h*A+m*O+w*M;e[10]=p*A+g*O+E*M;e[11]=d*A+y*O+S*M;if(t!==e){e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}return e};mat4.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[4],o=t[5],u=t[6],a=t[7],f=t[8],l=t[9],c=t[10],h=t[11];if(t!==e){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[4]=s*i+f*r;e[5]=o*i+l*r;e[6]=u*i+c*r;e[7]=a*i+h*r;e[8]=f*i-s*r;e[9]=l*i-o*r;e[10]=c*i-u*r;e[11]=h*i-a*r;return e};mat4.rotateY=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],u=t[2],a=t[3],f=t[8],l=t[9],c=t[10],h=t[11];if(t!==e){e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=s*i-f*r;e[1]=o*i-l*r;e[2]=u*i-c*r;e[3]=a*i-h*r;e[8]=s*r+f*i;e[9]=o*r+l*i;e[10]=u*r+c*i;e[11]=a*r+h*i;return e};mat4.rotateZ=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],u=t[2],a=t[3],f=t[4],l=t[5],c=t[6],h=t[7];if(t!==e){e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=s*i+f*r;e[1]=o*i+l*r;e[2]=u*i+c*r;e[3]=a*i+h*r;e[4]=f*i-s*r;e[5]=l*i-o*r;e[6]=c*i-u*r;e[7]=h*i-a*r;return e};mat4.fromRotationTranslation=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=r+r,a=i+i,f=s+s,l=r*u,c=r*a,h=r*f,p=i*a,d=i*f,v=s*f,m=o*u,g=o*a,y=o*f;e[0]=1-(p+v);e[1]=c+y;e[2]=h-g;e[3]=0;e[4]=c-y;e[5]=1-(l+v);e[6]=d+m;e[7]=0;e[8]=h+g;e[9]=d-m;e[10]=1-(l+p);e[11]=0;e[12]=n[0];e[13]=n[1];e[14]=n[2];e[15]=1;return e};mat4.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=n+n,u=r+r,a=i+i,f=n*o,l=r*o,c=r*u,h=i*o,p=i*u,d=i*a,v=s*o,m=s*u,g=s*a;e[0]=1-c-d;e[1]=l+g;e[2]=h-m;e[3]=0;e[4]=l-g;e[5]=1-f-d;e[6]=p+v;e[7]=0;e[8]=h+m;e[9]=p-v;e[10]=1-f-c;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};mat4.frustum=function(e,t,n,r,i,s,o){var u=1/(n-t),a=1/(i-r),f=1/(s-o);e[0]=s*2*u;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=s*2*a;e[6]=0;e[7]=0;e[8]=(n+t)*u;e[9]=(i+r)*a;e[10]=(o+s)*f;e[11]=-1;e[12]=0;e[13]=0;e[14]=o*s*2*f;e[15]=0;return e};mat4.perspective=function(e,t,n,r,i){var s=1/Math.tan(t/2),o=1/(r-i);e[0]=s/n;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=s;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=(i+r)*o;e[11]=-1;e[12]=0;e[13]=0;e[14]=2*i*r*o;e[15]=0;return e};mat4.ortho=function(e,t,n,r,i,s,o){var u=1/(t-n),a=1/(r-i),f=1/(s-o);e[0]=-2*u;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=-2*a;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=2*f;e[11]=0;e[12]=(t+n)*u;e[13]=(i+r)*a;e[14]=(o+s)*f;e[15]=1;return e};mat4.lookAt=function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d=t[0],v=t[1],m=t[2],g=r[0],y=r[1],b=r[2],w=n[0],E=n[1],S=n[2];if(Math.abs(d-w)<GLMAT_EPSILON&&Math.abs(v-E)<GLMAT_EPSILON&&Math.abs(m-S)<GLMAT_EPSILON){return mat4.identity(e)}l=d-w;c=v-E;h=m-S;p=1/Math.sqrt(l*l+c*c+h*h);l*=p;c*=p;h*=p;i=y*h-b*c;s=b*l-g*h;o=g*c-y*l;p=Math.sqrt(i*i+s*s+o*o);if(!p){i=0;s=0;o=0}else{p=1/p;i*=p;s*=p;o*=p}u=c*o-h*s;a=h*i-l*o;f=l*s-c*i;p=Math.sqrt(u*u+a*a+f*f);if(!p){u=0;a=0;f=0}else{p=1/p;u*=p;a*=p;f*=p}e[0]=i;e[1]=u;e[2]=l;e[3]=0;e[4]=s;e[5]=a;e[6]=c;e[7]=0;e[8]=o;e[9]=f;e[10]=h;e[11]=0;e[12]=-(i*d+s*v+o*m);e[13]=-(u*d+a*v+f*m);e[14]=-(l*d+c*v+h*m);e[15]=1;return e};mat4.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"};mat4.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))};if(typeof exports!=="undefined"){exports.mat4=mat4}var OMEGA=OMEGA||{};OMEGA.Utils=function(){};OMEGA.Utils.prototype.LoadScript=function(e,t){var n=document.getElementsByTagName("head")[0];var r=document.createElement("script");r.type="text/javascript";r.src=e;r.onreadystatechange=t;r.onload=t;n.appendChild(r)};OMEGA.Utils.prototype.LoadScripts=function(e,t){for(var n=0;n<e.length;n++){this.LoadScript(e[n],n<e.length-1?null:t)}};OMEGA.Utils.prototype.LoadImages=function(e,t){var n=[];var r=e.length;var i=function(){if(--r==0)t(n)};for(var s=0;s<r;++s){var o=this.LoadImage(e[s],i);n.push(o)}};OMEGA.Utils.prototype.LoadImage=function(e,t){var n=new Image;n.src=e;n.onload=t;return n};OMEGA.Utils.Counter=function(){this.startTime=(new Date).getTime();this.time=(new Date).getTime();this.frameTime=0;this.framesNumber=0;this.FPS=0};OMEGA.Utils.Counter.prototype.update=function(){this.framesNumber++;this.frameTime=((new Date).getTime()-this.time)/1e3;if(this.frameTime>1){this.FPS=Math.round(this.framesNumber/this.frameTime);this.time=(new Date).getTime();this.framesNumber=0}};OMEGA.Utils.Counter.prototype.getFPS=function(){return this.FPS};OMEGA.Utils.Counter.prototype.getFrame=function(){return this.framesNumber};OMEGA.Utils.Counter.prototype.getFrameTime=function(){return this.frameTime};OMEGA.Utils.Counter.prototype.getTime=function(){return((new Date).getTime()-this.startTime)/1e3};var OMEGA=OMEGA||{};OMEGA.Omega3D=OMEGA.Omega3D||{};OMEGA.Omega3D=function(e){this.canvas=e||document.getElementById("omega");this.shaderController=new OMEGA.Omega3D.controllers.ShaderController;this.imageController=new OMEGA.Omega3D.controllers.ImageController;this.scenes=[];this.cameras=[];this.shaders=[];try{this.gl=this.canvas.getContext("experimental-webgl");this.gl.viewPortWidth=this.canvas.width;this.gl.viewPortHeight=this.canvas.height}catch(t){console.error("[Omega3D] Cant initiate WebGL!")}if(!this.gl)console.log("Cant initiate WebGL");OMEGA.Omega3D.GL=this.gl;console.log(".: Omega3D v"+OMEGA.Omega3D.VERSION+" :.")};OMEGA.Omega3D.prototype.GetGL=function(){return this.gl};OMEGA.Omega3D.GL=null;OMEGA.Omega3D.LIGHTS=[];OMEGA.Omega3D.PointSize=1;OMEGA.Omega3D.VERSION="0.0.1.2 Alpha";OMEGA.Omega3D.ScenesCount=0;OMEGA.Omega3D.ObjectsCount=0;OMEGA.Omega3D.MaterialsCount=0;var Omega3D=OMEGA.Omega3D;OMEGA.Omega3D.Object3D=Object3D;OMEGA.Omega3D.Object3D.DEFAULT=0;OMEGA.Omega3D.Object3D.POINTS=1;OMEGA.Omega3D.Object3D.WIREFRAME=2;OMEGA.Omega3D.Scene=function(){this.id=(++OMEGA.Omega3D.ScenesCount).toString();this.name="Scene_"+this.id;this.renderer=null;this.gl=OMEGA.Omega3D.GL;this.children=new Array;this.objects=new Array;this.materials=new Array;this.list=new Array;this.lights=new Array;this.counter=new OMEGA.Utils.Counter;this.color={r:0,g:0,b:0,a:1};this.gl.enable(this.gl.DEPTH_TEST);this.gl.clearColor(this.color.r,this.color.g,this.color.b,this.color.a);this.getLights=function(){return this.lights};this.addLight=function(e){this.lights.push(e)};this.removeLight=function(e){this.lights.splice(this.lights.indeOf(e),1)};this.getColor=function(){return this.color};this.setColor=function(e,t,n){this.color={r:e,g:t,b:n,a:1};this.gl.clearColor(this.color.r,this.color.g,this.color.b,this.color.a)};this.checkForMaterial=function(e){for(var t=0;t<this.materials.length;t++){if(this.materials[t].id==e)return true}return false};this.setName=function(e){this.name=e};this.getName=function(){return this.name};this.getID=function(){return this.id};this.getMaterials=function(e){return materials[e]};this.getObjectsFromMaterialID=function(e){return objects[e]}};OMEGA.Omega3D.Scene.prototype.getGL=function(){return this.gl};OMEGA.Omega3D.Scene.prototype.addChild=function(e){this.children.push(e);if(!this.checkForMaterial(e.GetMaterial().GetID()))this.materials.push({id:e.GetMaterial().GetID(),material:e.GetMaterial()});var t=e.GetMaterial().GetID();if(t=="")t="default";if(this.objects[t]==null){this.objects[t]=new Array}this.objects[t].push(e);if(this.list[t]==null){this.list[t]={head:null,tail:null};}if(this.list[t].head==null){this.list[t].head=e;this.list[t].tail=e}else{e.prev=this.list[t].tail;this.list[t].tail.next=e;this.list[t].tail=e}};OMEGA.Omega3D.Scene.prototype.removeChild=function(e){for(var t=0;t<this.children.length;t++){if(this.children[t]==e)this.children.splice(t,1)}var n,r;if(object.prev){n=object.prev;object.prev=null}if(object.next){r=object.next;object.next=null}if(n&&r){n.next=r;r.prev=n}var i=e.GetMaterial().GetID();if(this.list[i].head==object)this.list[i].head=null;if(this.list[i].tail==object)this.list[i].tail=null;for(var t=0;t<this.objects[i].length;t++){if(this.objects[i][t]==e){this.objects[i].splice(t,1)}}if(this.objects[i].length==0)this.objects[i]=null;e=null};OMEGA.Omega3D.Scene.prototype.updateTimer=function(){this.counter.update()};OMEGA.Omega3D.Scene.prototype.getTime=function(){return this.counter.getTime()};OMEGA.Omega3D.Scene.prototype.getFPS=function(){return this.counter.getFPS()};OMEGA.Omega3D.Scene.prototype.getFrameNumber=function(){return this.counter.getFrame()};Cube.prototype=new Object3D;OMEGA.Omega3D.Cube=Cube;Cylinder.prototype=new Object3D;OMEGA.Omega3D.Cylinder=Cylinder;OMEGA.Omega3D.Light=function(e,t,n){this.position=[0,0,0];this.direction=[0,0,0];this.ambientColor=e||[.25,.25,.25];this.diffuseColor=t||[.7,.7,.7];this.specularColor=n||[1,1,1];OMEGA.Omega3D.LIGHTS.push(this)};OMEGA.Omega3D.Light.prototype.SetPosition=function(e,t,n){this.position[0]=e;this.position[1]=t;this.position[2]=n};OMEGA.Omega3D.Light.prototype.SetDirection=function(e,t,n){this.direction[0]=e;this.direction[1]=t;this.direction[2]=n};OMEGA.Omega3D.Light.prototype.SetAmbientColor=function(e,t,n){this.ambientColor[0]=e;this.ambientColor[1]=t;this.ambientColor[2]=n};OMEGA.Omega3D.Light.prototype.SetDiffuseColor=function(e,t,n){this.diffuseColor[0]=e;this.diffuseColor[1]=t;this.diffuseColor[2]=n};OMEGA.Omega3D.Light.prototype.SetSpecularColor=function(e,t,n){this.specularColor[0]=e;this.specularColor[1]=t;this.specularColor[2]=n};Plane.prototype=new Object3D;OMEGA.Omega3D.Plane=Plane;Sphere.prototype=new Object3D;OMEGA.Omega3D.Sphere=Sphere;Torus.prototype=new Object3D;OMEGA.Omega3D.Torus=Torus;Camera.prototype=new Object3D;OMEGA.Omega3D.cameras=OMEGA.Omega3D.cameras||{};OMEGA.Omega3D.cameras.Camera=Camera;FreeCamera.prototype=new Camera;OMEGA.Omega3D.cameras=OMEGA.Omega3D.cameras||{};OMEGA.Omega3D.cameras.FreeCamera=FreeCamera;OMEGA.Omega3D.controllers=OMEGA.Omega3D.controllers||{};OMEGA.Omega3D.controllers.ImageController=function(){};OMEGA.Omega3D.controllers.ImageController.prototype.LoadImages=function(e,t){var n=[];var r=e.length;console.log("----------------------------");console.log("Loading images...");var i=function(){console.log(r+" loaded...");if(--r==0)t(n)};for(var s=0;s<r;++s){var o=this.LoadImage(e[s],i);n.push(o)}};OMEGA.Omega3D.controllers.ImageController.prototype.LoadImage=function(e,t){var n=new Image;n.src=e;n.onload=t;return n};OMEGA.Omega3D.Material=Material;OMEGA.Omega3D.controllers=OMEGA.Omega3D.controllers||{};OMEGA.Omega3D.controllers.ShaderController=function(){this.shaders=new Array};OMEGA.Omega3D.controllers.ShaderController.prototype.LoadShaders=function(e,t){console.log("----------------------------");console.log("Loading Shaders...");for(var n=0;n<e.length;++n){console.log(e[n].vs_path);console.log(e[n].fs_path);e[n].vs_src=this.LoadShaderSource(e[n].vs_path);e[n].fs_src=this.LoadShaderSource(e[n].fs_path);this.shaders[e[n].id]=e[n]}t(this.shaders)};OMEGA.Omega3D.controllers.ShaderController.prototype.LoadShaderSource=function(e){var t=new XMLHttpRequest;t.open("GET",e,false);t.send();return t.responseText};OMEGA.Omega3D.controllers.ShaderController.prototype.GetShaderSourceFromElement=function(e){var t=document.getElementById(e);if(!t)return null;var n="";var r=t.firstChild;while(r){if(r.nodeType==3)n+=r.textContent;r=r.nextSibling}return n};OMEGA.Omega3D.Shaders=OMEGA.Omega3D.Shaders||{};OMEGA.Omega3D.Shaders.Components=OMEGA.Omega3D.Shaders.Components||{};OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float=function(){return"precision mediump float;"};OMEGA.Omega3D.Shaders.Components.Basic_TextureCoords=function(){return"vTexCoord = aTextureCoord;"};OMEGA.Omega3D.Shaders.Components.Basic_Includes=function(){var e="attribute vec2 aTextureCoord;"+"attribute vec3 aVertexPos;"+"attribute vec3 aVertexNormal;"+"uniform float uPointSize;"+"uniform mat4 uModelMatrix;"+"uniform mat4 uProjectionMatrix;"+"uniform mat4 uViewMatrix;"+"uniform mat4 uInvViewMatrix;"+"uniform mat4 uNormalMatrix;";return e};OMEGA.Omega3D.Shaders.Components.Basic_Includes_Post_Processing=function(){var e="attribute vec2 aTextureCoord;"+"attribute vec3 aVertexPos;"+"attribute vec3 aVertexNormal;"+"uniform float uTime;"+"uniform mat4 uModelMatrix;"+"uniform mat4 uProjectionMatrix;"+"uniform mat4 uViewMatrix;"+"uniform mat4 uNormalMatrix;";return e};OMEGA.Omega3D.Shaders.Components.Vertex_World_Conversion_V3=function(e,t){return e+" = uProjectionMatrix * uViewMatrix * uModelMatrix *    vec4("+t+", 1.0);"};OMEGA.Omega3D.Shaders.Components.Basic_Fragment_Logic=function(e){return"gl_FragColor = "+e+";"};OMEGA.Omega3D.Shaders.Components.Noise3D=function(){var e="vec3 mod289(vec3 x) {"+"return x - floor(x * (1.0 / 289.0)) * 289.0;"+"}"+"vec4 mod289(vec4 x) {"+"return x - floor(x * (1.0 / 289.0)) * 289.0;"+"}"+"vec4 permute(vec4 x) {"+"return mod289(((x*34.0)+1.0)*x);"+"}"+"vec4 taylorInvSqrt(vec4 r){"+"return 1.79284291400159 - 0.85373472095314 * r;"+"}"+"vec3 fade(vec3 t) {"+"return t*t*t*(t*(t*6.0-15.0)+10.0);"+"}"+"float pnoise(vec3 P, vec3 rep){"+"    vec3 Pi0 = mod(floor(P), rep);"+"    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep);"+"    Pi0 = mod289(Pi0);"+"    Pi1 = mod289(Pi1);"+"    vec3 Pf0 = fract(P);"+"    vec3 Pf1 = Pf0 - vec3(1.0);"+"    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);"+"    vec4 iy = vec4(Pi0.yy, Pi1.yy);"+"   vec4 iz0 = Pi0.zzzz;"+"   vec4 iz1 = Pi1.zzzz;"+"    vec4 ixy = permute(permute(ix) + iy);"+"    vec4 ixy0 = permute(ixy + iz0);"+"    vec4 ixy1 = permute(ixy + iz1);"+"    vec4 gx0 = ixy0 * (1.0 / 7.0);"+"    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;"+"    gx0 = fract(gx0);"+"    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);"+"     vec4 sz0 = step(gz0, vec4(0.0));"+"    gx0 -= sz0 * (step(0.0, gx0) - 0.5);"+"    gy0 -= sz0 * (step(0.0, gy0) - 0.5);"+"    vec4 gx1 = ixy1 * (1.0 / 7.0);"+"    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;"+"    gx1 = fract(gx1);"+"    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);"+"    vec4 sz1 = step(gz1, vec4(0.0));"+"    gx1 -= sz1 * (step(0.0, gx1) - 0.5);"+"    gy1 -= sz1 * (step(0.0, gy1) - 0.5);"+"    vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);"+"    vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);"+"    vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);"+"    vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);"+"   vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);"+"    vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);"+"    vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);"+"   vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);"+"    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));"+"    g000 *= norm0.x;"+"   g010 *= norm0.y;"+"    g100 *= norm0.z;"+"   g110 *= norm0.w;"+"    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));"+"    g001 *= norm1.x;"+"    g011 *= norm1.y;"+"   g101 *= norm1.z;"+"   g111 *= norm1.w;"+"    float n000 = dot(g000, Pf0);"+"    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));"+"    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));"+"   float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));"+"    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));"+"    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));"+"    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));"+"    float n111 = dot(g111, Pf1);"+"    vec3 fade_xyz = fade(Pf0);"+"    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);"+"    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);"+"    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);"+"    return 2.2 * n_xyz;"+"}";return e};OMEGA.Omega3D.Shaders.Components.Basic_Light_Includes=function(){var e="uniform vec3 uLightPosition;"+"uniform vec3 uLightDirection;"+"uniform vec3 uAmbientColor;"+"uniform vec3 uDiffuseColor;"+"uniform vec3 uSpecularColor;";return e};OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying=function(){var e="varying vec3 vNormalEye;"+"varying vec4 vPositionEye4;";return e};OMEGA.Omega3D.Shaders.Components.Basic_Diffuse_Vertex_Logic=function(){var e="vPositionEye4 = gl_Position;"+"vec4 temp = uNormalMatrix * vec4(aVertexNormal,0.0);"+"vNormalEye = normalize(temp.xyz);";return e};OMEGA.Omega3D.Shaders.Components.Basic_Diffuse_Fragment_Logic=function(e){var t="vec3 vectorToLightSource    = normalize(uLightPosition.xyz-vPositionEye4.xyz );"+"float diffuseLightWeighting = max(dot(vNormalEye, vectorToLightSource), 0.0);"+"vec3 lightWeighting = uAmbientColor + "+"uDiffuseColor * diffuseLightWeighting;"+"vec4 texelColor = "+e+"gl_FragColor = vec4( lightWeighting.rgb * texelColor.rgb, texelColor.a);";return t};OMEGA.Omega3D.Shaders.Components.Basic_Phong_Fragment_Logic=function(e){var t="vec3 vectorToLightSource    = normalize(uLightPosition.xyz-vPositionEye4.xyz );"+"float diffuseLightWeighting = max(dot(vNormalEye, vectorToLightSource), 0.0);"+"vec3 reflectionVector       = normalize(reflect(-vectorToLightSource, vNormalEye));"+"vec3 viewVectorEye  = normalize(vPositionEye4.xyz);"+"float rdotv  = max(dot(reflectionVector, viewVectorEye), 0.0);"+"float specularLightWeighting = pow(rdotv, 8.0);"+"vec3 lightWeighting = uAmbientColor + "+"uDiffuseColor * diffuseLightWeighting + "+"uSpecularColor * specularLightWeighting;"+"vec4 texelColor = "+e+"gl_FragColor = vec4( lightWeighting.rgb * texelColor.rgb, texelColor.a);";return t};OMEGA.Omega3D.Shader=Shader;PostProcessingShader.prototype=new Shader;OMEGA.Omega3D.PostProcessingShader=PostProcessingShader;OMEGA.Omega3D.Shaders=OMEGA.Omega3D.Shaders||{};OMEGA.Omega3D.Shaders.Basic=function(e){var t,n;e=e||false;if(e)t="varying vec2 vTexCoord;";else t="";var r=OMEGA.Omega3D.Shaders.Components.Basic_Includes();r=r+t;r=r+"void main(void){gl_PointSize = uPointSize;";r=r+OMEGA.Omega3D.Shaders.Components.Vertex_World_Conversion_V3("gl_Position","aVertexPos");if(e)r=r+OMEGA.Omega3D.Shaders.Components.Basic_TextureCoords("vTexCoord");r=r+"}";if(e){t="uniform sampler2D uSampler;"+"varying vec2 vTexCoord;";n="texture2D(uSampler, vec2(vTexCoord.s, vTexCoord.t));"}else{n="vec4(0.8, 0.4, 0.0, 1.0);"}var i=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float();if(e)i=i+t;i=i+"void main(void){";i=i+OMEGA.Omega3D.Shaders.Components.Basic_Fragment_Logic(n);i=i+"}";return new OMEGA.Omega3D.Shader(r,i)};OMEGA.Omega3D.Shaders.Diffuse=function(e){var t,n;e=e||false;if(e)t="varying vec2 vTexCoord;";else t="";var r=OMEGA.Omega3D.Shaders.Components.Basic_Includes();if(OMEGA.Omega3D.LIGHTS.length>0)r=r+OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying();r=r+t;r=r+"void main(void){gl_PointSize = uPointSize;";r=r+OMEGA.Omega3D.Shaders.Components.Vertex_World_Conversion_V3("gl_Position","aVertexPos");if(e)r=r+OMEGA.Omega3D.Shaders.Components.Basic_TextureCoords("vTexCoord");if(OMEGA.Omega3D.LIGHTS.length>0)r=r+OMEGA.Omega3D.Shaders.Components.Basic_Diffuse_Vertex_Logic();r=r+"}";if(e){t="uniform sampler2D uSampler;"+"varying vec2 vTexCoord;";n="texture2D(uSampler, vec2(vTexCoord.s, vTexCoord.t));"}else{n="vec4(0.8, 0.4, 0.0, 1.0);"}var i=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float();if(OMEGA.Omega3D.LIGHTS.length>0)i=i+OMEGA.Omega3D.Shaders.Components.Basic_Light_Includes()+OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying();if(e)i=i+t;i=i+"void main(void){";if(OMEGA.Omega3D.LIGHTS.length>0)i=i+OMEGA.Omega3D.Shaders.Components.Basic_Diffuse_Fragment_Logic(n);else i=i+OMEGA.Omega3D.Shaders.Components.Basic_Fragment_Logic(n);i=i+"}";return new OMEGA.Omega3D.Shader(r,i)};OMEGA.Omega3D.Shaders.Phong=function(e){var t,n;e=e||false;if(e)t="varying vec2 vTexCoord;";else t="";var r=OMEGA.Omega3D.Shaders.Components.Basic_Includes();if(OMEGA.Omega3D.LIGHTS.length>0)r=r+OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying();r=r+t;r=r+"void main(void){ gl_PointSize = uPointSize;";r=r+OMEGA.Omega3D.Shaders.Components.Vertex_World_Conversion_V3("gl_Position","aVertexPos");if(e)r=r+OMEGA.Omega3D.Shaders.Components.Basic_TextureCoords("vTexCoord");if(OMEGA.Omega3D.LIGHTS.length>0)r=r+OMEGA.Omega3D.Shaders.Components.Basic_Diffuse_Vertex_Logic();r=r+"}";if(e){t="uniform sampler2D uSampler;"+"varying vec2 vTexCoord;";n="texture2D(uSampler, vec2(vTexCoord.s, vTexCoord.t));"}else{n="vec4(0.8, 0.4, 0.0, 1.0);"}var i=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float();if(OMEGA.Omega3D.LIGHTS.length>0)i=i+OMEGA.Omega3D.Shaders.Components.Basic_Light_Includes()+OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying();if(e)i=i+t;i=i+"void main(void){";if(OMEGA.Omega3D.LIGHTS.length>0)i=i+OMEGA.Omega3D.Shaders.Components.Basic_Phong_Fragment_Logic(n);else i=i+OMEGA.Omega3D.Shaders.Components.Basic_Fragment_Logic(n);i=i+"}";return new OMEGA.Omega3D.Shader(r,i)};OMEGA.Omega3D.Shaders.CubeMap=function(){var e=OMEGA.Omega3D.Shaders.Components.Basic_Includes()+"varying vec3 vTexCoord;"+"void main(void){"+OMEGA.Omega3D.Shaders.Components.Vertex_World_Conversion_V3("gl_Position","aVertexPos")+"vTexCoord = (vec4(aVertexPos, 0.0)).xyz;"+"}";var t=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float()+"uniform samplerCube uSampler;"+"varying vec3 vTexCoord;"+"void main(void){"+"gl_FragColor = textureCube(uSampler, vTexCoord);"+"}";return new OMEGA.Omega3D.Shader(e,t)};OMEGA.Omega3D.Shaders.PostProcessing=function(){var e=OMEGA.Omega3D.Shaders.Components.Basic_Includes_Post_Processing()+"varying float vTime;"+"varying vec2 vTexCoord;"+"void main(void){"+"vec4 pos = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPos.xy, 0.0, 1.0);"+"gl_Position = pos;"+"vTexCoord = aTextureCoord;"+"vTime = uTime;"+"}";var t=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float()+"uniform sampler2D uSampler;"+"varying float vTime;"+"varying vec2 vTexCoord;"+"float rand(vec2 co){"+"return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);"+"}"+"float rand1(float co){"+"return fract(sin(dot(co ,78.233)) * 43758.5453);"+"}"+"void main(void){"+"vec4 color = texture2D(uSampler, vec2(vTexCoord.s, vTexCoord.t));"+"float check = rand1(vTime);"+"if(check <= 0.005 ){ gl_FragColor = vec4(0.25, 0.25, 0.25, 1.0) + rand(vec2(vTime* 10.0, rand(vTexCoord))); }"+"else if(check > 0.005 && check <= 0.015){ gl_FragColor = color + rand(vec2(vTime* 10.0, rand(vTexCoord))); }"+"else if(check > 0.015 ){ gl_FragColor = color ; }"+"}";return new OMEGA.Omega3D.PostProcessingShader(e,t)};OMEGA.Omega3D.Shaders.Morph=function(){var e=OMEGA.Omega3D.Shaders.Components.Basic_Includes_Post_Processing()+OMEGA.Omega3D.Shaders.Components.Noise3D();if(OMEGA.Omega3D.LIGHTS.length>0)e=e+OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying();e=e+"varying float noise;"+"float turbulence( vec3 p ) {"+"float w =100.0;"+"float t = -0.5;"+"for (float f = 1.0 ; f <= 10.0 ; f++ ){"+"float power = pow( 2.0, f );"+"t += abs( pnoise( vec3( power * p ), vec3( 10.0, 10.0, 10.0 ) ) / power );"+"}"+" return t;"+"}"+"varying float vTime;"+"varying vec2 vTexCoord;"+"varying vec3 vVertexNormal;"+"void main(void){"+"vec4 pos = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPos.xy, 0.0, 1.0);"+"noise = 10.0 *  -.10 * turbulence(.5*aVertexNormal + uTime * 0.025);"+"float b = 5.0 * pnoise(0.05 * aVertexPos, vec3(100.0) );"+"float displacement = - 1.5 * noise + b;"+"vec3 newPos = aVertexPos + aVertexNormal * displacement;"+"vVertexNormal = abs(aVertexNormal * displacement);"+"gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix *vec4(newPos, 1.0);"+"vTexCoord = aTextureCoord;"+"vTime = uTime;";if(OMEGA.Omega3D.LIGHTS.length>0)e=e+OMEGA.Omega3D.Shaders.Components.Basic_Diffuse_Vertex_Logic();e=e+"}";var t=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float();if(OMEGA.Omega3D.LIGHTS.length>0)t=t+OMEGA.Omega3D.Shaders.Components.Basic_Light_Includes()+OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying();t=t+"uniform sampler2D uSampler;"+"varying float vTime;"+"varying vec2 vTexCoord;"+"varying float noise;"+"void main(void){"+"float n = noise;"+"if(noise < 0.05)n = 0.05;"+"if(noise > 0.4)n = 0.4;"+"float ypos = 1.0-1.3*n;"+"if(ypos < 0.0) ypos = 0.0;"+"vec2 tPos = vec2(0, ypos*1.7);";var n="texture2D(uSampler, tPos);";if(OMEGA.Omega3D.LIGHTS.length>0)t=t+OMEGA.Omega3D.Shaders.Components.Basic_Phong_Fragment_Logic(n);else t=t+OMEGA.Omega3D.Shaders.Components.Basic_Fragment_Logic(n);t=t+"}";return new OMEGA.Omega3D.PostProcessingShader(e,t)};OMEGA.Omega3D.Shaders.CubemapReflection=function(){var e="attribute vec2 aTextureCoord;"+"attribute vec3 aVertexPos;"+"attribute vec3 aVertexNormal;"+"uniform float uPointSize;"+"uniform mat4 uModelMatrix;"+"uniform mat4 uProjectionMatrix;"+"uniform mat4 uViewMatrix;"+"uniform mat4 uInvViewMatrix;"+"uniform mat4 uNormalMatrix;"+"varying vec3 vTexCoord;"+"void main(void){"+"   vec4 vEyeNormal = uNormalMatrix * vec4(aVertexNormal, 0.0);"+"   vec4 vVert4 = uViewMatrix * uModelMatrix * vec4(aVertexPos, 1.0);"+"   vec3 vEyeVertex = normalize(vVert4.xyz/vVert4.w);"+"   vec4 vCoords = vec4(reflect(vEyeVertex.xyz, vEyeNormal.xyz), 1.0);"+"   vCoords = uInvViewMatrix * vCoords;"+"   vTexCoord.xyz = normalize(vCoords.xyz);"+"   gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix *vec4(aVertexPos, 1.0);"+"}";var t=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float()+"varying vec3 vTexCoord;"+"uniform samplerCube uSampler;"+"void main(void){"+"   gl_FragColor = textureCube(uSampler, vTexCoord);"+"}";return new OMEGA.Omega3D.Shader(e,t)};OMEGA.Omega3D.Shaders.PostProcessingKernel=function(e){var t=OMEGA.Omega3D.Shaders.Components.Basic_Includes_Post_Processing()+"varying vec2 vTexCoord;"+"void main(void){"+"vec4 pos = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPos.xy, 0.0, 1.0);"+"gl_Position = pos;"+"vTexCoord = aTextureCoord;"+"}";var n=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float()+"uniform float uKernel[9];"+"uniform sampler2D uSampler;"+"varying vec2 vTexCoord;"+"void main(void){"+"vec4 color = texture2D(uSampler, vec2(vTexCoord.s, vTexCoord.t));"+"vec2 onePixel = vec2(1.0, 1.0) / vec2(512, 512);"+"vec4 colorSum ="+"texture2D(uSampler, vTexCoord + onePixel * vec2(-1, -1)) * uKernel[1] + "+"texture2D(uSampler, vTexCoord + onePixel * vec2( 0, -1)) * uKernel[1] + "+"texture2D(uSampler, vTexCoord + onePixel * vec2( 1, -1)) * uKernel[2] + "+"texture2D(uSampler, vTexCoord + onePixel * vec2(-1,  0)) * uKernel[3] + "+"texture2D(uSampler, vTexCoord + onePixel * vec2( 0,  0)) * uKernel[4] + "+"texture2D(uSampler, vTexCoord + onePixel * vec2( 1,  0)) * uKernel[5] + "+"texture2D(uSampler, vTexCoord + onePixel * vec2(-1,  1)) * uKernel[6] + "+"texture2D(uSampler, vTexCoord + onePixel * vec2( 0,  1)) * uKernel[7] + "+"texture2D(uSampler, vTexCoord + onePixel * vec2( 1,  1)) * uKernel[8];";var r="float kernelWeight = uKernel[0] + uKernel[1] + uKernel[2] + uKernel[3] + uKernel[4] + uKernel[5] + uKernel[6] +uKernel[7] +uKernel[8];"+"if(kernelWeight <= 0.0){"+"kernelWeight = 1.0;"+"}";n=n+r;n=n+"gl_FragColor = vec4((colorSum / kernelWeight).rgb, 1);"+"}";return new OMEGA.Omega3D.PostProcessingKernelShader(t,n,e)};OMEGA.Omega3D.Shaders.PostProcessingKernel.Kernels={normal:[0,0,0,0,1,0,0,0,0],gaussianBlur:[.045,.122,.045,.122,.332,.122,.045,.122,.045],gaussianBlur2:[1,2,1,2,4,2,1,2,1],gaussianBlur3:[0,1,0,1,1,1,0,1,0],gaussianBlur4:[0,16,0,16,0,16,0,16,0],unsharpen:[-1,-1,-1,-1,9,-1,-1,-1,-1],sharpness:[0,-1,0,-1,5,-1,0,-1,0],sharpen:[0,-1,0,-1,16,-1,0,-1,0],edgeDetect:[-.125,-.125,-.125,-.125,1,-.125,-.125,-.125,-.125],edgeDetect2:[-1,-1,-1,-1,8,-1,-1,-1,-1],edgeDetect3:[-5,0,0,0,0,0,0,0,5],edgeDetect4:[-1,-1,-1,0,0,0,1,1,1],edgeDetect5:[-1,-1,-1,2,2,2,-1,-1,-1],edgeDetect6:[-5,-5,-5,-5,39,-5,-5,-5,-5],sobelHorizontal:[1,2,1,0,0,0,-1,-2,-1],sobelVertical:[1,0,-1,2,0,-2,1,0,-1],previtHorizontal:[1,1,1,0,0,0,-1,-1,-1],previtVertical:[1,0,-1,1,0,-1,1,0,-1],boxBlur:[.111,.111,.111,.111,.111,.111,.111,.111,.111],robbieBlur:[0,0,0,0,12,0,0,0,0],triangleBlur:[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625],emboss:[-2,-1,0,-1,1,1,0,1,2]};PostProcessingKernelShader.prototype=new Shader;OMEGA.Omega3D.PostProcessingKernelShader=PostProcessingKernelShader;OMEGA.Omega3D.Texture=Texture;FrameBufferTexture.prototype=new Texture;OMEGA.Omega3D.FrameBufferTexture=FrameBufferTexture;CubemapTexture.prototype=new Texture;OMEGA.Omega3D.CubemapTexture=CubemapTexture;BasicTexture.prototype=new Texture;OMEGA.Omega3D.BasicTexture=BasicTexture;OMEGA.Omega3D.Mesh=Mesh;OMEGA.Omega3D.Geometry=Geometry;CubeGeometry.prototype=new Geometry;OMEGA.Omega3D.Geometry.CubeGeometry=CubeGeometry;CylinderGeometry.prototype=new Geometry;OMEGA.Omega3D.Geometry.CylinderGeometry=CylinderGeometry;SphereGeometry.prototype=new Geometry;OMEGA.Omega3D.Geometry.SphereGeometry=SphereGeometry;SquareGeometry.prototype=new Geometry;OMEGA.Omega3D.Geometry.SquareGeometry=SquareGeometry;TorusGeometry.prototype=new Geometry;OMEGA.Omega3D.Geometry.TorusGeometry=TorusGeometry;TriangleGeometry.prototype=new Geometry;OMEGA.Omega3D.Geometry.TriangleGeometry=TriangleGeometry;OMEGA.Omega3D.parsers=OMEGA.Omega3D.parsers||{};OMEGA.Omega3D.parsers.OBJParser=OBJParser;OMEGA.Omega3D.RenderPass=RenderPass;OMEGA.Omega3D.WebGLRenderer=WebGLRenderer;