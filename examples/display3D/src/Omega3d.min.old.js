function BasicRenderer(e,t){function a(e,t){if(m(i,{id:e,material:t}))return;i.push({id:e,material:t})}function f(e,t){if(e=="")e="default";if(s[e]==null){s[e]=new Array}s[e].push(t);if(o[e]==null){o[e]={head:null,tail:null};}if(o[e].head==null){o[e].head=t;o[e].tail=t}else{t.prev=o[e].tail;o[e].tail.next=t;o[e].tail=t}}function l(e,t){var n,r;if(t.prev){n=t.prev;t.prev=null}if(t.next){r=t.next;t.next=null}if(n&&r){n.next=r;r.prev=n}if(o[e].head==t)o[e].head=null;if(o[e].tail==t)o[e].tail=null;for(var i=0;i<s[e].length;i++){if(s[e][i]==t){s[e].splice(i,1)}}if(s[e].length==0)s[e]=null;t=null}function c(e){return i[e]}function h(e){return s[e]}function p(e,t){if(u)console.log("Renderer.Render START");e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);e.viewport(0,0,e.viewPortWidth,e.viewPortHeight);e.clearColor(0,0,0,1);mat4.perspective(n,45,e.viewPortWidth/e.viewPortHeight,.1,100);for(var r=0;r<i.length;r++){var a=i[r].id;var f=i[r].material;if(s[a].length==0)continue;if(u){console.log("Current Material ID :  "+a+"\nAmount Objects for this material: "+s[a].length)}if(f.GetTexture().needsUpdate)f.GetTexture().Update();f.Enable();if(OMEGA.Omega3D.LIGHTS.length>0)v(e,f);var l=o[a].head;while(l){if(l.mayRender){d(e,l,f,t);if(u)console.log("-  Current object: "+l)}l=l.next}f.Disable()}if(u)console.log("Renderer.Render END")}function d(e,t,r,i){var s=r.GetShader().GetProgram();e.enableVertexAttribArray(s.aVertexPos);e.bindBuffer(e.ARRAY_BUFFER,t.GetMesh().GetVertexBuffer());e.vertexAttribPointer(s.aVertexPos,t.GetMesh().GetVertexBuffer().itemSize,e.FLOAT,false,0,0);if(s.aTextureCoord!=-1){e.enableVertexAttribArray(s.aTextureCoord);e.bindBuffer(e.ARRAY_BUFFER,t.GetMesh().GetUVBuffer());e.vertexAttribPointer(s.aTextureCoord,t.GetMesh().GetUVBuffer().itemSize,e.FLOAT,false,0,0)}if(s.aVertexNormal!=-1){e.enableVertexAttribArray(s.aVertexNormal);e.bindBuffer(e.ARRAY_BUFFER,t.GetMesh().GetNormalBuffer());e.vertexAttribPointer(s.aVertexNormal,t.GetMesh().GetNormalBuffer().itemSize,e.FLOAT,false,0,0)}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.GetMesh().GetIndexBuffer());e.uniformMatrix4fv(s.uProjectionMatrix,false,n);e.uniformMatrix4fv(s.uViewMatrix,false,i.GetMatrix());e.uniformMatrix4fv(s.uModelMatrix,false,t.GetModelView());var o=mat4.create();mat4.multiply(o,t.GetModelView(),i.GetMatrix());mat4.invert(o,o);mat4.transpose(o,o);e.uniformMatrix4fv(s.uNormalMatrix,false,o);e.uniform1f(s.uPointSize,parseFloat(OMEGA.Omega3D.PointSize));if(t.drawType==OMEGA.Omega3D.Object3D.DEFAULT)e.drawElements(e.TRIANGLES,t.GetMesh().GetIndexBuffer().numItems,e.UNSIGNED_SHORT,t.GetMesh().GetIndexBuffer());else if(t.drawType==OMEGA.Omega3D.Object3D.WIREFRAME)e.drawElements(e.LINE_STRIP,t.GetMesh().GetIndexBuffer().numItems,e.UNSIGNED_SHORT,t.GetMesh().GetIndexBuffer());else if(t.drawType==OMEGA.Omega3D.Object3D.POINTS)e.drawArrays(e.POINTS,0,t.GetMesh().GetVertexBuffer().numItems);t.identity()}function v(e,t){var n=t.GetShader().GetProgram();n.uLightPosition=e.getUniformLocation(n,"uLightPosition");n.uLightDirection=e.getUniformLocation(n,"uLightDirection");n.uAmbientColor=e.getUniformLocation(n,"uAmbientColor");n.uDiffuseColor=e.getUniformLocation(n,"uDiffuseColor");n.uSpecularColor=e.getUniformLocation(n,"uSpecularColor");if(n.uLightPosition!=-1)e.uniform3fv(n.uLightPosition,OMEGA.Omega3D.LIGHTS[0].position);if(n.uLightDirection!=-1)e.uniform3fv(n.uAmbientColor,OMEGA.Omega3D.LIGHTS[0].ambientColor);if(n.uAmbientColor!=-1)e.uniform3fv(n.uAmbientColor,OMEGA.Omega3D.LIGHTS[0].ambientColor);if(n.uDiffuseColor!=-1)e.uniform3fv(n.uDiffuseColor,OMEGA.Omega3D.LIGHTS[0].diffuseColor);if(n.uSpecularColor!=-1)e.uniform3fv(n.uSpecularColor,OMEGA.Omega3D.LIGHTS[0].specularColor)}function m(e,t){for(var n=0;n<e.length;n++){if(e[n]===t){return true}}return false}var n=null;var r=null;var i=null;var s=null;var o=null;var u=t;var e=e;__construct=function(){n=mat4.create();i=new Array;s=new Array;o=new Array;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}()}();return{AddMaterial:a,AddObject:f,RemoveObject:l,GetMaterial:c,GetObjectFromMaterialID:h,Render:p}}var OMEGA=OMEGA||{};OMEGA.Utils=function(){};OMEGA.Utils.prototype.LoadScript=function(e,t){var n=document.getElementsByTagName("head")[0];var r=document.createElement("script");r.type="text/javascript";r.src=e;r.onreadystatechange=t;r.onload=t;n.appendChild(r)};OMEGA.Utils.prototype.LoadScripts=function(e,t){for(var n=0;n<e.length;n++){this.LoadScript(e[n],n<e.length-1?null:t)}};OMEGA.Utils.prototype.LoadImages=function(e,t){var n=[];var r=e.length;var i=function(){if(--r==0)t(n)};for(var s=0;s<r;++s){var o=this.LoadImage(e[s],i);n.push(o)}};OMEGA.Utils.prototype.LoadImage=function(e,t){var n=new Image;n.src=e;n.onload=t;return n};OMEGA.Utils.Counter=function(){this.startTime=(new Date).getTime();this.time=(new Date).getTime();this.frameTime=0;this.framesNumber=0;this.FPS=0};OMEGA.Utils.Counter.prototype.update=function(){this.framesNumber++;this.frameTime=((new Date).getTime()-this.time)/1e3;if(this.frameTime>1){this.FPS=Math.round(this.framesNumber/this.frameTime);this.time=(new Date).getTime();this.framesNumber=0}};OMEGA.Utils.Counter.prototype.getFPS=function(){return this.FPS};OMEGA.Utils.Counter.prototype.getFrame=function(){return this.framesNumber};OMEGA.Utils.Counter.prototype.getFrameTime=function(){return this.frameTime};OMEGA.Utils.Counter.prototype.getTime=function(){return((new Date).getTime()-this.startTime)/1e3};var OMEGA=OMEGA||{};OMEGA.Omega3D=OMEGA.Omega3D||{};OMEGA.Omega3D=function(e){this.canvas=e||document.getElementById("omega");this.shaderController=new OMEGA.Omega3D.controllers.ShaderController;this.imageController=new OMEGA.Omega3D.controllers.ImageController;this.scenes=[];this.cameras=[];this.shaders=[];try{this.gl=this.canvas.getContext("experimental-webgl");this.gl.viewPortWidth=this.canvas.width;this.gl.viewPortHeight=this.canvas.height}catch(t){console.error("[Omega3D] Cant initiate WebGL!")}if(!this.gl)console.log("Cant initiate WebGL");OMEGA.Omega3D.GL=this.gl;console.log(".: Omega3D v"+OMEGA.Omega3D.VERSION+" :.")};OMEGA.Omega3D.prototype.GetGL=function(){return this.gl};OMEGA.Omega3D.prototype.GetShaderSource=function(e){return this.shaderController.GetShaderSourceFromElement(e)};OMEGA.Omega3D.prototype.LoadImages=function(e,t){this.imageController.LoadImages(e,t)};OMEGA.Omega3D.prototype.LoadShaders=function(e,t){this.shaderController.LoadShaders(e,t)};OMEGA.Omega3D.prototype.CreateView=function(){var e=new OMEGA.Omega3D.Scene(this.gl);this.scenes.push(e);return e};OMEGA.Omega3D.prototype.CreateMaterial=function(e,t,n){var r=new OMEGA.Omega3D.Material(e,t,n);return r};OMEGA.Omega3D.prototype.CreateMesh=function(e){return new OMEGA.Omega3D.Mesh(e,this.GetGL())};OMEGA.Omega3D.prototype.CreateTexture=function(e,t){return new OMEGA.Omega3D.Texture(this.GetGL(),e,e.length>0,t)};OMEGA.Omega3D.prototype.CreateObject3D=function(e,t,n){var r=new OMEGA.Omega3D.Object3D(e,t);if(n==true)this.AddChild(r);return r};OMEGA.Omega3D.prototype.CreateSkyBox=function(e){var t=new OMEGA.Omega3D.Shaders.CubeMap;var n=omega.CreateTexture(e);var r=new OMEGA.Omega3D.Shader(t.vs_src,t.fs_src,this.GetGL());var i=omega.CreateMaterial("omega_skybox",n,r);var s=new OMEGA.Omega3D.Mesh(new OMEGA.Omega3D.Geometry.Cube(5),this.GetGL());var o=new OMEGA.Omega3D.Object3D(s,i);this.AddChild(o);return o};OMEGA.Omega3D.GL=null;OMEGA.Omega3D.LIGHTS=[];OMEGA.Omega3D.PointSize=3;OMEGA.Omega3D.VERSION="0.0.1 Alpha";OMEGA.Omega3D.MaterialsCount=0;var Omega3D=OMEGA.Omega3D;OMEGA.Omega3D.renderer=OMEGA.Omega3D.renderer||{};OMEGA.Omega3D.renderer.BASIC=BasicRenderer;OMEGA.Omega3D.Mesh=function(e){this.vertexBuffer;this.normalBuffer;this.indexBuffer;this.uvBuffer;this.geometry=e;this.gl=OMEGA.Omega3D.GL};OMEGA.Omega3D.Mesh.prototype.GetVertexBuffer=function(){return this.vertexBuffer};OMEGA.Omega3D.Mesh.prototype.GetUVBuffer=function(){return this.uvBuffer};OMEGA.Omega3D.Mesh.prototype.GetIndexBuffer=function(){return this.indexBuffer};OMEGA.Omega3D.Mesh.prototype.GetNormalBuffer=function(){return this.normalBuffer};OMEGA.Omega3D.Mesh.prototype.GetIndexCount=function(){return this.geometry.GetIndexes()/3};OMEGA.Omega3D.Mesh.prototype.GetGeometry=function(e){return this.geometry};OMEGA.Omega3D.Mesh.prototype.ApplyGeometry=function(e){this.geometry=e};OMEGA.Omega3D.Mesh.prototype.CreateBuffers=function(){this.vertexBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.geometry.GetVertices()),this.gl.STATIC_DRAW);this.vertexBuffer.itemSize=3;this.vertexBuffer.numItems=this.geometry.GetVertices().length/this.vertexBuffer.itemSize;this.normalBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.normalBuffer);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.geometry.GetNormals()),this.gl.STATIC_DRAW);this.normalBuffer.itemSize=3;this.normalBuffer.numItems=this.geometry.GetNormals().length/3;this.indexBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.geometry.GetIndexes()),this.gl.STATIC_DRAW);this.indexBuffer.itemSize=1;this.indexBuffer.numItems=this.geometry.GetIndexes().length;this.uvBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvBuffer);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.geometry.GetUVS()),this.gl.STATIC_DRAW);this.uvBuffer.itemSize=2;this.uvBuffer.numItems=this.geometry.GetUVS().length/this.uvBuffer.itemSize};OMEGA.Omega3D.Geometry=OMEGA.Omega3D.Geometry||{};OMEGA.Omega3D.Geometry.Triangle=function(e){var t=new Array;var n=new Array;var r=new Array;var i=new Array;e=e||.1;t=[0,1*e,0,-1*e,-1*e,0,1*e,-1*e,0];r=[1,1,1,0,0,1];n=[0,0,1,0,0,1,0,0,1];i=[0,1,2];console.log("GEOMETRY : triangle created");return{GetVertices:function(){return t},GetNormals:function(){return n},GetUVS:function(){return r},GetIndexes:function(){return i}}};OMEGA.Omega3D.Geometry.Square=function(e){var t=new Array;var n=new Array;var r=new Array;var i=new Array;e=e||.25;var s=e*.5;t=[-1*s,1*s,0,-1*s,-1*s,0,1*s,-1*s,0,1*s,1*s,0];n=[0,0,1,0,0,1,0,0,1,0,0,1];r=[0,0,1,0,0,1,1,1];i=[0,1,2,0,2,3];console.log("GEOMETRY : square created");return{GetVertices:function(){return t},GetNormals:function(){return n},GetUVS:function(){return r},GetIndexes:function(){return i}}};OMEGA.Omega3D.Geometry.Sphere=function(e){var t=new Array;var n=new Array;var r=new Array;var i=new Array;var s=e||.1;var o=15;var u=15;var a=0;var f=0;for(var l=0;l<o;l++){for(var c=0;c<u;c++){a=Math.PI*2/(u-1)*c;f=Math.PI*l/(o-1)-Math.PI/2;var h=Math.cos(a)*s*Math.cos(f);var p=Math.sin(f)*s;var d=Math.sin(a)*s*Math.cos(f);t.push(h);t.push(p);t.push(d);n.push(Math.cos(a)*Math.cos(f),Math.sin(f),Math.sin(a)*Math.cos(f));r.push(c/(u-1),1-l/(o-1))}}for(var l=0;l<o;l++){for(var c=0;c<u;c++){if(l<o-1&&c<u-1){i.push(l*u+c,l*u+c+1,(l+1)*u+c);i.push(l*u+c+1,(l+1)*u+c+1,(l+1)*u+c)}}}console.log("GEOMETRY : sphere created");return{GetVertices:function(){return t},GetNormals:function(){return n},GetUVS:function(){return r},GetIndexes:function(){return i}}};OMEGA.Omega3D.Geometry.Cube=function(e){var t=new Array;var n=new Array;var r=new Array;var i=new Array;e=e||.1;var s=e;t=[-1*s,-1*s,1*s,1*s,-1*s,1*s,1*s,1*s,1*s,-1*s,1*s,1*s,-1*s,-1*s,-1*s,-1*s,1*s,-1*s,1*s,1*s,-1*s,1*s,-1*s,-1*s,-1*s,1*s,-1*s,-1*s,1*s,1*s,1*s,1*s,1*s,1*s,1*s,-1*s,-1*s,-1*s,-1*s,1*s,-1*s,-1*s,1*s,-1*s,1*s,-1*s,-1*s,1*s,1*s,-1*s,-1*s,1*s,1*s,-1*s,1*s,1*s,1*s,1*s,-1*s,1*s,-1*s,-1*s,-1*s,-1*s,-1*s,1*s,-1*s,1*s,1*s,-1*s,1*s,-1*s];n=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0];i=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];r=[0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1];console.log("GEOMETRY : cube created");return{GetVertices:function(){return t},GetNormals:function(){return n},GetUVS:function(){return r},GetIndexes:function(){return i}}};OMEGA.Omega3D.Geometry.Cillinder=function(e,t){var n=new Array;var r=new Array;var i=new Array;var s=new Array;var o=e||.25;var u=t||.05;var a=50;var f=50;var l=.5;var c,h,p;var d,v;for(var m=0;m<f;m++){for(var g=0;g<a;g++){d=Math.PI*2/(a-1)*g;v=Math.PI*m/(f-1)-Math.PI/2;c=Math.cos(d)*u;h=m*(o/f)-o/2;p=Math.sin(d)*u;n.push(c);n.push(h);n.push(p);r.push(Math.cos(d));r.push(0);r.push(Math.sin(d));i.push(g/(a-1));i.push(m/(f-1));if(m<f-1&&g<a-1){s.push(m*a+g);s.push(m*a+g+1);s.push((m+1)*a+g);s.push(m*a+g+1);s.push((m+1)*a+g+1);s.push((m+1)*a+g)}}}console.log("GEOMETRY : cillinder created");return{GetVertices:function(){return n},GetNormals:function(){return r},GetUVS:function(){return i},GetIndexes:function(){return s}}};OMEGA.Omega3D.Geometry.Torus=function(e){var t=new Array;var n=new Array;var r=new Array;var i=new Array;var s=55;var o=55;var u=e||.1;var a=u/2;var f,l,c,h,p,d;var v=0;var m=0;for(var g=0;g<s;g++){v=Math.PI*2/(s-1)*g;for(var y=0;y<o;y++){m=Math.PI*2/(o-1)*y;f=Math.cos(v)*(Math.cos(m)*a+u);l=Math.sin(v)*(Math.cos(m)*a+u);c=Math.sin(m)*a;h=Math.cos(v)*Math.cos(m);p=Math.sin(v)*Math.cos(m);d=Math.sin(m);t.push(f);t.push(l);t.push(c);n.push(h);n.push(p);n.push(d);r.push(y/(o-1));r.push(g/(s-1));if(g<s-1&&y<o-1){i.push(g*o+y);i.push(g*o+y+1);i.push((g+1)*o+y);i.push(g*o+y+1);i.push((g+1)*o+y+1);i.push((g+1)*o+y)}}}console.log("GEOMETRY : torus created");return{GetVertices:function(){return t},GetNormals:function(){return n},GetUVS:function(){return r},GetIndexes:function(){return i}}};OMEGA.Omega3D.Material=function(e,t){this.materialID="material_"+ ++OMEGA.Omega3D.MaterialsCount;this.texture=t;this.shader=e};OMEGA.Omega3D.Material.prototype.GetTexture=function(){return this.texture};OMEGA.Omega3D.Material.prototype.GetShader=function(){return this.shader};OMEGA.Omega3D.Material.prototype.GetID=function(){return this.materialID};OMEGA.Omega3D.Material.prototype.Enable=function(){if(this.shader)this.shader.Enable();if(this.texture)this.texture.Enable(this.shader)};OMEGA.Omega3D.Material.prototype.Disable=function(){if(this.shader)this.shader.Disable();if(this.texture)this.texture.Disable()};OMEGA.Omega3D.Texture=function(e,t,n){this.gl_context=OMEGA.Omega3D.GL;this.img=e;this.isCubeMap=t||false;this.needsUpdate=n||false;this.tex=this.gl_context.createTexture();if(!this.isCubeMap){this.handleTexture2DLoaded(this.img,this.tex)}else{this.handleTextureCubeMapLoaded(this.img,this.tex)}};OMEGA.Omega3D.Texture.prototype.GetTexture=function(){return this.tex};OMEGA.Omega3D.Texture.prototype.GetImage=function(){return this.img};OMEGA.Omega3D.Texture.prototype.handleTexture2DLoaded=function(e,t){if(!this.needsUpdate){this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,t);this.gl_context.pixelStorei(this.gl_context.UNPACK_FLIP_Y_WEBGL,true);if(e)this.gl_context.texImage2D(this.gl_context.TEXTURE_2D,0,this.gl_context.RGBA,this.gl_context.RGBA,this.gl_context.UNSIGNED_BYTE,e);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MAG_FILTER,this.gl_context.NEAREST);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MIN_FILTER,this.gl_context.NEAREST);this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,null)}else{this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,t);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MAG_FILTER,this.gl_context.LINEAR);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MIN_FILTER,this.gl_context.LINEAR);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_WRAP_S,this.gl_context.CLAMP_TO_EDGE);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_WRAP_T,this.gl_context.CLAMP_TO_EDGE)}};OMEGA.Omega3D.Texture.prototype.handleTextureCubeMapLoaded=function(e,t){this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,t);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_WRAP_S,this.gl_context.CLAMP_TO_EDGE);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_WRAP_T,this.gl_context.CLAMP_TO_EDGE);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_MIN_FILTER,this.gl_context.LINEAR);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_MAG_FILTER,this.gl_context.LINEAR);var n=[this.gl_context.TEXTURE_CUBE_MAP_POSITIVE_X,this.gl_context.TEXTURE_CUBE_MAP_NEGATIVE_X,this.gl_context.TEXTURE_CUBE_MAP_POSITIVE_Y,this.gl_context.TEXTURE_CUBE_MAP_NEGATIVE_Y,this.gl_context.TEXTURE_CUBE_MAP_POSITIVE_Z,this.gl_context.TEXTURE_CUBE_MAP_NEGATIVE_Z];for(var r=0;r<n.length;r++){var i=n[r];var s=e[r];this.gl_context.pixelStorei(this.gl_context.UNPACK_FLIP_Y_WEBGL,false);this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,t);this.gl_context.texImage2D(i,0,this.gl_context.RGBA,this.gl_context.RGBA,this.gl_context.UNSIGNED_BYTE,s);this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,null)}return t};OMEGA.Omega3D.Texture.prototype.Enable=function(e){this.gl_context.activeTexture(this.gl_context.TEXTURE0);if(!this.isCubeMap)this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,this.tex);else{this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,this.tex)}if(e){var t=this.gl_context.getUniformLocation(e.GetProgram(),"uSampler");this.gl_context.uniform1i(t,0)}};OMEGA.Omega3D.Texture.prototype.Disable=function(){if(!this.isCubeMap)this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,null);else{this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,null)}};OMEGA.Omega3D.Texture.prototype.Update=function(){this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,this.tex);this.gl_context.pixelStorei(this.gl_context.UNPACK_FLIP_Y_WEBGL,true);this.gl_context.texImage2D(this.gl_context.TEXTURE_2D,0,this.gl_context.RGBA,this.gl_context.RGBA,this.gl_context.UNSIGNED_BYTE,this.img)};OMEGA.Omega3D.Shaders=OMEGA.Omega3D.Shaders||{};OMEGA.Omega3D.Shaders.Components=OMEGA.Omega3D.Shaders.Components||{};OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float=function(){return"precision mediump float;"};OMEGA.Omega3D.Shaders.Components.Basic_TextureCoords=function(){return"vTexCoord = aTextureCoord;"};OMEGA.Omega3D.Shaders.Components.Basic_Includes=function(){var e="attribute vec2 aTextureCoord;"+"attribute vec3 aVertexPos;"+"attribute vec3 aVertexNormal;"+"uniform float uPointSize;"+"uniform mat4 uModelMatrix;"+"uniform mat4 uProjectionMatrix;"+"uniform mat4 uViewMatrix;"+"uniform mat4 uNormalMatrix;";return e};OMEGA.Omega3D.Shaders.Components.Vertex_World_Conversion=function(e,t){return e+" = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4("+t+", 1.0);"};OMEGA.Omega3D.Shaders.Components.Basic_Fragment_Logic=function(e){return"gl_FragColor = "+e+";"};OMEGA.Omega3D.Shaders.Components.Basic_Light_Includes=function(){var e="uniform vec3 uLightPosition;"+"uniform vec3 uLightDirection;"+"uniform vec3 uAmbientColor;"+"uniform vec3 uDiffuseColor;"+"uniform vec3 uSpecularColor;";return e};OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying=function(){var e="varying vec3 vNormalEye;"+"varying vec4 vPositionEye4;";return e};OMEGA.Omega3D.Shaders.Components.Basic_Diffuse_Vertex_Logic=function(){var e="vPositionEye4 = gl_Position;"+"vec4 temp = uNormalMatrix * vec4(aVertexNormal,1.0);"+"vNormalEye = normalize(temp.xyz);";return e};OMEGA.Omega3D.Shaders.Components.Basic_Diffuse_Fragment_Logic=function(e){var t="vec3 vectorToLightSource    = normalize(uLightPosition.xyz-vPositionEye4.xyz );"+"float diffuseLightWeighting = max(dot(vNormalEye, vectorToLightSource), 0.0);"+"vec3 lightWeighting = uAmbientColor + "+"uDiffuseColor * diffuseLightWeighting;"+"vec4 texelColor = "+e+"gl_FragColor = vec4( lightWeighting.rgb * texelColor.rgb, texelColor.a);";return t};OMEGA.Omega3D.Shaders.Components.Basic_Phong_Fragment_Logic=function(e){var t="vec3 vectorToLightSource    = normalize(uLightPosition.xyz-vPositionEye4.xyz );"+"float diffuseLightWeighting = max(dot(vNormalEye, vectorToLightSource), 0.0);"+"vec3 reflectionVector       = normalize(reflect(-vectorToLightSource, vNormalEye));"+"vec3 viewVectorEye  = normalize(vPositionEye4.xyz);"+"float rdotv  = max(dot(reflectionVector, viewVectorEye), 0.0);"+"float specularLightWeighting = pow(rdotv, 32.0);"+"vec3 lightWeighting = uAmbientColor + "+"uDiffuseColor * diffuseLightWeighting + "+"uSpecularColor * specularLightWeighting;"+"vec4 texelColor = "+e+"gl_FragColor = vec4( lightWeighting.rgb * texelColor.rgb, texelColor.a);";return t};OMEGA.Omega3D.Shader=function(e,t){this.vertex_shader_src=e;this.fragment_shader_src=t;this.gl_context=OMEGA.Omega3D.GL;this.vertex_shader=this.createShaderElement(this.gl_context.VERTEX_SHADER,this.vertex_shader_src);this.fragment_shader=this.createShaderElement(this.gl_context.FRAGMENT_SHADER,this.fragment_shader_src);this.program=this.createProgram();console.log("----------------------------");console.log("Creating shader");if(this.vertex_shader&&this.fragment_shader&&this.program)console.log("Shader created");console.log("----------------------------")};OMEGA.Omega3D.Shader.prototype.GetVertexShaderSource=function(){return this.vertex_shader_src};OMEGA.Omega3D.Shader.prototype.GetFragmentShaderSource=function(){return this.fragment_shader_src};OMEGA.Omega3D.Shader.prototype.GetVertexShader=function(){return this.vertex_shader};OMEGA.Omega3D.Shader.prototype.GetFragmentShader=function(){return this.fragment_shader};OMEGA.Omega3D.Shader.prototype.GetProgram=function(){return this.program};OMEGA.Omega3D.Shader.prototype.Enable=function(){if(!this.program)return;this.gl_context.useProgram(this.program)};OMEGA.Omega3D.Shader.prototype.Disable=function(){if(!this.program)return;this.gl_context.useProgram(null)};OMEGA.Omega3D.Shader.prototype.createProgram=function(){var e=this.gl_context.createProgram();this.gl_context.attachShader(e,this.vertex_shader);this.gl_context.attachShader(e,this.fragment_shader);this.gl_context.linkProgram(e);if(!this.gl_context.getProgramParameter(e,this.gl_context.LINK_STATUS)){console.log("Could not initialize shaders / program");return null}e.aVertexPos=this.gl_context.getAttribLocation(e,"aVertexPos");e.aTextureCoord=this.gl_context.getAttribLocation(e,"aTextureCoord");e.aVertexNormal=this.gl_context.getAttribLocation(e,"aVertexNormal");e.uPointSize=this.gl_context.getUniformLocation(e,"uPointSize");e.uProjectionMatrix=this.gl_context.getUniformLocation(e,"uProjectionMatrix");e.uViewMatrix=this.gl_context.getUniformLocation(e,"uViewMatrix");e.uModelMatrix=this.gl_context.getUniformLocation(e,"uModelMatrix");e.uNormalMatrix=this.gl_context.getUniformLocation(e,"uNormalMatrix");return e};OMEGA.Omega3D.Shader.prototype.createShaderElement=function(e,t){var n=this.gl_context.createShader(e);this.gl_context.shaderSource(n,t);this.gl_context.compileShader(n);if(!this.gl_context.getShaderParameter(n,this.gl_context.COMPILE_STATUS)){console.log(this.gl_context.getShaderInfoLog(n));return null}else{console.log("Shader succesfully compiled!")}return n};OMEGA.Omega3D.Shaders=OMEGA.Omega3D.Shaders||{};OMEGA.Omega3D.Shaders.Basic=function(e){var t,n;e=e||false;if(e)t="varying vec2 vTexCoord;";else t="";var r=OMEGA.Omega3D.Shaders.Components.Basic_Includes();r=r+t;r=r+"void main(void){gl_PointSize = uPointSize;";r=r+OMEGA.Omega3D.Shaders.Components.Vertex_World_Conversion("gl_Position","aVertexPos");if(e)r=r+OMEGA.Omega3D.Shaders.Components.Basic_TextureCoords("vTexCoord");r=r+"}";if(e){t="uniform sampler2D uSampler;"+"varying vec2 vTexCoord;";n="texture2D(uSampler, vec2(vTexCoord.s, vTexCoord.t));"}else{n="vec4(0.4, 0.0, 0.0, 1.0);"}var i=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float();if(e)i=i+t;i=i+"void main(void){";i=i+OMEGA.Omega3D.Shaders.Components.Basic_Fragment_Logic(n);i=i+"}";return new OMEGA.Omega3D.Shader(r,i)};OMEGA.Omega3D.Shaders.Diffuse=function(e){var t,n;e=e||false;if(e)t="varying vec2 vTexCoord;";else t="";var r=OMEGA.Omega3D.Shaders.Components.Basic_Includes();if(OMEGA.Omega3D.LIGHTS.length>0)r=r+OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying();r=r+t;r=r+"void main(void){gl_PointSize = uPointSize;";r=r+OMEGA.Omega3D.Shaders.Components.Vertex_World_Conversion("gl_Position","aVertexPos");if(e)r=r+OMEGA.Omega3D.Shaders.Components.Basic_TextureCoords("vTexCoord");if(OMEGA.Omega3D.LIGHTS.length>0)r=r+OMEGA.Omega3D.Shaders.Components.Basic_Diffuse_Vertex_Logic();r=r+"}";if(e){t="uniform sampler2D uSampler;"+"varying vec2 vTexCoord;";n="texture2D(uSampler, vec2(vTexCoord.s, vTexCoord.t));"}else{n="vec4(0.4, 0.0, 0.0, 1.0);"}var i=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float();if(OMEGA.Omega3D.LIGHTS.length>0)i=i+OMEGA.Omega3D.Shaders.Components.Basic_Light_Includes()+OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying();if(e)i=i+t;i=i+"void main(void){";if(OMEGA.Omega3D.LIGHTS.length>0)i=i+OMEGA.Omega3D.Shaders.Components.Basic_Diffuse_Fragment_Logic(n);else i=i+OMEGA.Omega3D.Shaders.Components.Basic_Fragment_Logic(n);i=i+"}";return new OMEGA.Omega3D.Shader(r,i)};OMEGA.Omega3D.Shaders.Phong=function(e){var t,n;e=e||false;if(e)t="varying vec2 vTexCoord;";else t="";var r=OMEGA.Omega3D.Shaders.Components.Basic_Includes();if(OMEGA.Omega3D.LIGHTS.length>0)r=r+OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying();r=r+t;r=r+"void main(void){ gl_PointSize = uPointSize;";r=r+OMEGA.Omega3D.Shaders.Components.Vertex_World_Conversion("gl_Position","aVertexPos");if(e)r=r+OMEGA.Omega3D.Shaders.Components.Basic_TextureCoords("vTexCoord");if(OMEGA.Omega3D.LIGHTS.length>0)r=r+OMEGA.Omega3D.Shaders.Components.Basic_Diffuse_Vertex_Logic();r=r+"}";if(e){t="uniform sampler2D uSampler;"+"varying vec2 vTexCoord;";n="texture2D(uSampler, vec2(vTexCoord.s, vTexCoord.t));"}else{n="vec4(0.4, 0.0, 0.0, 1.0);"}var i=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float();if(OMEGA.Omega3D.LIGHTS.length>0)i=i+OMEGA.Omega3D.Shaders.Components.Basic_Light_Includes()+OMEGA.Omega3D.Shaders.Components.Basic_Light_Varying();if(e)i=i+t;i=i+"void main(void){";if(OMEGA.Omega3D.LIGHTS.length>0)i=i+OMEGA.Omega3D.Shaders.Components.Basic_Phong_Fragment_Logic(n);else i=i+OMEGA.Omega3D.Shaders.Components.Basic_Fragment_Logic(n);i=i+"}";return new OMEGA.Omega3D.Shader(r,i)};OMEGA.Omega3D.Shaders.PointLight=function(){};OMEGA.Omega3D.Shaders.CubeMap=function(){var e=OMEGA.Omega3D.Shaders.Components.Basic_Includes()+"varying vec3 vTexCoord;"+"void main(void){"+OMEGA.Omega3D.Shaders.Components.Vertex_World_Conversion("gl_Position","aVertexPos")+"vTexCoord = (vec4(aVertexPos, 0.0)).xyz;"+"}";var t=OMEGA.Omega3D.Shaders.Components.Fragment_Precision_Mediump_Float()+"uniform samplerCube uSampler;"+"varying vec3 vTexCoord;"+"void main(void){"+"gl_FragColor = textureCube(uSampler, vTexCoord);"+"}";return new OMEGA.Omega3D.Shader(e,t)};OMEGA.Omega3D.Texture=function(e,t,n){this.gl_context=OMEGA.Omega3D.GL;this.img=e;this.isCubeMap=t||false;this.needsUpdate=n||false;this.tex=this.gl_context.createTexture();if(!this.isCubeMap){this.handleTexture2DLoaded(this.img,this.tex)}else{this.handleTextureCubeMapLoaded(this.img,this.tex)}};OMEGA.Omega3D.Texture.prototype.GetTexture=function(){return this.tex};OMEGA.Omega3D.Texture.prototype.GetImage=function(){return this.img};OMEGA.Omega3D.Texture.prototype.handleTexture2DLoaded=function(e,t){if(!this.needsUpdate){this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,t);this.gl_context.pixelStorei(this.gl_context.UNPACK_FLIP_Y_WEBGL,true);if(e)this.gl_context.texImage2D(this.gl_context.TEXTURE_2D,0,this.gl_context.RGBA,this.gl_context.RGBA,this.gl_context.UNSIGNED_BYTE,e);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MAG_FILTER,this.gl_context.NEAREST);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MIN_FILTER,this.gl_context.NEAREST);this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,null)}else{this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,t);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MAG_FILTER,this.gl_context.LINEAR);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_MIN_FILTER,this.gl_context.LINEAR);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_WRAP_S,this.gl_context.CLAMP_TO_EDGE);this.gl_context.texParameteri(this.gl_context.TEXTURE_2D,this.gl_context.TEXTURE_WRAP_T,this.gl_context.CLAMP_TO_EDGE)}};OMEGA.Omega3D.Texture.prototype.handleTextureCubeMapLoaded=function(e,t){this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,t);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_WRAP_S,this.gl_context.CLAMP_TO_EDGE);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_WRAP_T,this.gl_context.CLAMP_TO_EDGE);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_MIN_FILTER,this.gl_context.LINEAR);this.gl_context.texParameteri(this.gl_context.TEXTURE_CUBE_MAP,this.gl_context.TEXTURE_MAG_FILTER,this.gl_context.LINEAR);var n=[this.gl_context.TEXTURE_CUBE_MAP_POSITIVE_X,this.gl_context.TEXTURE_CUBE_MAP_NEGATIVE_X,this.gl_context.TEXTURE_CUBE_MAP_POSITIVE_Y,this.gl_context.TEXTURE_CUBE_MAP_NEGATIVE_Y,this.gl_context.TEXTURE_CUBE_MAP_POSITIVE_Z,this.gl_context.TEXTURE_CUBE_MAP_NEGATIVE_Z];for(var r=0;r<n.length;r++){var i=n[r];var s=e[r];this.gl_context.pixelStorei(this.gl_context.UNPACK_FLIP_Y_WEBGL,false);this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,t);this.gl_context.texImage2D(i,0,this.gl_context.RGBA,this.gl_context.RGBA,this.gl_context.UNSIGNED_BYTE,s);this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,null)}return t};OMEGA.Omega3D.Texture.prototype.Enable=function(e){this.gl_context.activeTexture(this.gl_context.TEXTURE0);if(!this.isCubeMap)this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,this.tex);else{this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,this.tex)}if(e){var t=this.gl_context.getUniformLocation(e.GetProgram(),"uSampler");this.gl_context.uniform1i(t,0)}};OMEGA.Omega3D.Texture.prototype.Disable=function(){if(!this.isCubeMap)this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,null);else{this.gl_context.bindTexture(this.gl_context.TEXTURE_CUBE_MAP,null)}};OMEGA.Omega3D.Texture.prototype.Update=function(){this.gl_context.bindTexture(this.gl_context.TEXTURE_2D,this.tex);this.gl_context.pixelStorei(this.gl_context.UNPACK_FLIP_Y_WEBGL,true);this.gl_context.texImage2D(this.gl_context.TEXTURE_2D,0,this.gl_context.RGBA,this.gl_context.RGBA,this.gl_context.UNSIGNED_BYTE,this.img)};OMEGA.Omega3D.Light=function(e,t,n){this.position=[0,0,0];this.direction=[0,0,0];this.ambientColor=e||[.25,.25,.25];this.diffuseColor=t||[.7,.7,.7];this.specularColor=n||[1,1,1];OMEGA.Omega3D.LIGHTS.push(this)};OMEGA.Omega3D.Light.prototype.SetPosition=function(e,t,n){this.position[0]=e;this.position[1]=t;this.position[2]=n};OMEGA.Omega3D.Light.prototype.SetDirection=function(e,t,n){this.direction[0]=e;this.direction[1]=t;this.direction[2]=n};OMEGA.Omega3D.Light.prototype.SetAmbientColor=function(e,t,n){this.ambientColor[0]=e;this.ambientColor[1]=t;this.ambientColor[2]=n};OMEGA.Omega3D.Light.prototype.SetDiffuseColor=function(e,t,n){this.diffuseColor[0]=e;this.diffuseColor[1]=t;this.diffuseColor[2]=n};OMEGA.Omega3D.Light.prototype.SetSpecularColor=function(e,t,n){this.specularColor[0]=e;this.specularColor[1]=t;this.specularColor[2]=n};OMEGA.Omega3D.Object3D=function(e,t){this.mayRender=true;this.next=null;this.prev=null;this.modelView=mat4.create();mat4.identity(this.modelView);this.mesh=e;this.material=t;this.drawType=t.GetTexture().GetImage()?OMEGA.Omega3D.Object3D.DEFAULT:OMEGA.Omega3D.Object3D.WIREFRAME;this.mesh.CreateBuffers();console.log("OBJECT3D : created ")};OMEGA.Omega3D.Object3D.prototype.GetMesh=function(){return this.mesh};OMEGA.Omega3D.Object3D.prototype.SetMesh=function(e){this.mayRender=false;this.mesh=e;this.mayRender=true};OMEGA.Omega3D.Object3D.prototype.GetMaterial=function(){return this.material};OMEGA.Omega3D.Object3D.prototype.GetModelView=function(){return this.modelView};OMEGA.Omega3D.Object3D.prototype.SetModelView=function(e){this.modelView=e;return this.GetModelView()};OMEGA.Omega3D.Object3D.prototype.identity=function(){mat4.identity(this.modelView)};OMEGA.Omega3D.Object3D.prototype.Translate=function(e,t,n){mat4.translate(this.modelView,this.modelView,[e,t,n])};OMEGA.Omega3D.Object3D.prototype.Rotate=function(e,t,n){this.RotateX(e);this.RotateY(t);this.RotateZ(n)};OMEGA.Omega3D.Object3D.prototype.RotateX=function(e){mat4.rotate(this.modelView,this.modelView,e,[1,0,0])};OMEGA.Omega3D.Object3D.prototype.RotateY=function(e){mat4.rotate(this.modelView,this.modelView,e,[0,1,0])};OMEGA.Omega3D.Object3D.prototype.RotateZ=function(e){mat4.rotate(this.modelView,this.modelView,e,[0,0,1])};OMEGA.Omega3D.Object3D.DEFAULT=0;OMEGA.Omega3D.Object3D.POINTS=1;OMEGA.Omega3D.Object3D.WIREFRAME=2;OMEGA.Omega3D.Scene=function(){this.renderer=null;this.gl=OMEGA.Omega3D.GL;this.cameras=new Array;this.children=new Array;this.counter=new OMEGA.Utils.Counter;this.renderer=new OMEGA.Omega3D.renderer.BASIC(this.gl,false);this.gl.enable(this.gl.DEPTH_TEST)};OMEGA.Omega3D.Scene.prototype.getGL=function(){return this.gl};OMEGA.Omega3D.Scene.prototype.addChild=function(e){this.children.push(e);this.renderer.AddMaterial(e.GetMaterial().GetID(),e.GetMaterial());this.renderer.AddObject(e.GetMaterial().GetID(),e)};OMEGA.Omega3D.Scene.prototype.removeChild=function(e){for(var t=0;t<this.children.length;t++){if(this.children[t]==e)this.children.splice(t,1)}this.renderer.RemoveObject(e.GetMaterial().GetID(),e)};OMEGA.Omega3D.Scene.prototype.addCamera=function(e){this.cameras.push(e)};OMEGA.Omega3D.Scene.prototype.renderScene=function(){this.renderer.Render(this.gl,this.cameras[0]);this.counter.update()};OMEGA.Omega3D.Scene.prototype.getTime=function(){return this.counter.getTime()};OMEGA.Omega3D.Scene.prototype.getFPS=function(){return this.counter.getFPS()};OMEGA.Omega3D.Scene.prototype.getFrameNumber=function(){return this.counter.getFrame()};OMEGA.Omega3D.controllers=OMEGA.Omega3D.controllers||{};OMEGA.Omega3D.controllers.ImageController=function(){};OMEGA.Omega3D.controllers.ImageController.prototype.LoadImages=function(e,t){var n=[];var r=e.length;console.log("----------------------------");console.log("Loading images...");var i=function(){console.log(r+" loaded...");if(--r==0)t(n)};for(var s=0;s<r;++s){var o=this.LoadImage(e[s],i);n.push(o)}};OMEGA.Omega3D.controllers.ImageController.prototype.LoadImage=function(e,t){var n=new Image;n.src=e;n.onload=t;return n};OMEGA.Omega3D.controllers=OMEGA.Omega3D.controllers||{};OMEGA.Omega3D.controllers.ShaderController=function(){this.shaders=new Array};OMEGA.Omega3D.controllers.ShaderController.prototype.LoadShaders=function(e,t){console.log("----------------------------");console.log("Loading Shaders...");for(var n=0;n<e.length;++n){console.log(e[n].vs_path);console.log(e[n].fs_path);e[n].vs_src=this.LoadShaderSource(e[n].vs_path);e[n].fs_src=this.LoadShaderSource(e[n].fs_path);this.shaders[e[n].id]=e[n]}t(this.shaders)};OMEGA.Omega3D.controllers.ShaderController.prototype.LoadShaderSource=function(e){var t=new XMLHttpRequest;t.open("GET",e,false);t.send();return t.responseText};OMEGA.Omega3D.controllers.ShaderController.prototype.GetShaderSourceFromElement=function(e){var t=document.getElementById(e);if(!t)return null;var n="";var r=t.firstChild;while(r){if(r.nodeType==3)n+=r.textContent;r=r.nextSibling}return n};OMEGA.Omega3D.cameras=OMEGA.Omega3D.cameras||{};OMEGA.Omega3D.cameras.Camera=function(){this.m=mat4.create();mat4.identity(this.m)};OMEGA.Omega3D.cameras.Camera.prototype.GetMatrix=function(){return this.m};OMEGA.Omega3D.cameras.Camera.prototype.update=function(){};OMEGA.Omega3D.cameras.Camera.prototype.RotateX=function(e){mat4.rotate(this.m,this.m,e,[1,0,0])};OMEGA.Omega3D.cameras.Camera.prototype.RotateY=function(e){mat4.rotate(this.m,this.m,e,[0,1,0])};OMEGA.Omega3D.cameras.Camera.prototype.RotateZ=function(e){mat4.rotate(this.m,this.m,e,[0,0,1])};OMEGA.Omega3D.cameras.Camera.prototype.Rotate=function(e,t,n){this.RotateX(e);this.RotateY(t);this.RotateZ(n)};OMEGA.Omega3D.cameras.Camera.prototype.Translate=function(e,t,n){mat4.translate(this.m,this.m,[e,t,n])};OMEGA.Omega3D.cameras=OMEGA.Omega3D.cameras||{};OMEGA.Omega3D.cameras.KeyCamera=function(){this.m=mat4.create();mat4.identity(this.m);this.speed=.01;this.drag=.01;this.pos=new Vector3D(0,0,0);this.vel=new Vector3D(0,0,0);this.acc=new Vector3D(0,0,0);this.currentlyPressedKeys={};document.onkeydown=this.HandleKeyDown;document.onkeyup=this.HandleKeyUp};OMEGA.Omega3D.cameras.KeyCamera.prototype.GetMatrix=function(){return this.m};OMEGA.Omega3D.cameras.KeyCamera.prototype.update=function(){this.handleKeys();this.vel.x+=this.acc.x;this.vel.y+=this.acc.y;this.vel.z+=this.acc.z;this.vel.x*=this.drag;this.vel.y*=this.drag;this.vel.z*=this.drag;this.pos.x+=this.vel.x;this.pos.y+=this.vel.y;this.pos.z+=this.vel.z;this.acc.x=this.acc.y=this.acc.z=0;this.vel.x=this.vel.y=this.vel.z=0;this.Translate(this.pos.x,this.pos.y,this.pos.z)};OMEGA.Omega3D.cameras.KeyCamera.prototype.Translate=function(e,t,n){mat4.translate(this.m,this.m,[e,t,n])};OMEGA.Omega3D.cameras.KeyCamera.prototype.RotateX=function(e){mat4.rotate(this.m,this.m,e,[1,0,0])};OMEGA.Omega3D.cameras.KeyCamera.prototype.RotateY=function(e){mat4.rotate(this.m,this.m,e,[0,1,0])};OMEGA.Omega3D.cameras.KeyCamera.prototype.RotateZ=function(e){mat4.rotate(this.m,this.m,e,[0,0,1])};OMEGA.Omega3D.cameras.KeyCamera.prototype.Rotate=function(e,t,n){this.RotateX(e);this.RotateY(t);this.RotateZ(n)};OMEGA.Omega3D.cameras.KeyCamera.prototype.HandleKeyDown=function(e){this.currentlyPressedKeys[e.keyCode]=true};OMEGA.Omega3D.cameras.KeyCamera.prototype.HandleKeyUp=function(e){this.currentlyPressedKeys[e.keyCode]=false};OMEGA.Omega3D.cameras.KeyCamera.prototype.HandleKeys=function(){if(this.currentlyPressedKeys[38]||this.currentlyPressedKeys[87]){this.vel.z=0;this.acc.z=this.speed}if(this.currentlyPressedKeys[40]||this.currentlyPressedKeys[83]){this.vel.z=0;this.acc.z=-this.speed}if(this.currentlyPressedKeys[39]||this.currentlyPressedKeys[68]){this.vel.x=0;this.acc.x=-this.speed}if(this.currentlyPressedKeys[37]||this.currentlyPressedKeys[65]){this.vel.x=0;this.acc.x=this.speed}};